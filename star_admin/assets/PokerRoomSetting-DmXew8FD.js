var se=Object.defineProperty;var U=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var j=(n,i,s)=>i in n?se(n,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[i]=s,q=(n,i)=>{for(var s in i||(i={}))ie.call(i,s)&&j(n,s,i[s]);if(U)for(var s of U(i))re.call(i,s)&&j(n,s,i[s]);return n};var f=(n,i,s)=>new Promise((y,g)=>{var C=u=>{try{v(s.next(u))}catch(_){g(_)}},w=u=>{try{v(s.throw(u))}catch(_){g(_)}},v=u=>u.done?y(u.value):Promise.resolve(u.value).then(C,w);v((s=s.apply(n,i)).next())});import{u as me}from"./useTable-YuVhaX40.js";import{_ as ue}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{_ as ce}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{r as h,h as p,I as $,_ as de}from"./index-YGSL2gxf.js";/* empty css                   *//* empty css               */import{_ as fe}from"./Write.vue_vue_type_script_setup_true_lang-CtLj8MOJ.js";import{_ as ge}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{n as ve,a3 as T,k as _e,b as c}from"./element-plus-B2PLgZHf.js";import{v as be,V as G,r as m,u as o,j as ye,M as l,H as R,x as L,y as we,K as d,B as ke,a3 as B,k as H,J,P as K,G as O}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./index-DOJE_sUj.js";import"./useValidator-DY0gbKVw.js";/* empty css                  */function Se(n){return h.post({url:"/poker_room/select",data:{page:n.page,pageNum:n.pageSize,game_code:n.game_code}})}function Q(n){return h.post({url:"/poker_room/update",data:n})}function Pe(n){return h.post({url:"/poker_room/delete",data:{ids:n}})}const Re={class:"mb-10px"},Be=be({__name:"PokerRoomSetting",setup(n){const i=G([{field:"game_name",label:"游戏名称",component:"Input"}]),s=m({}),y=a=>{s.value=a,P()},g=m({}),{tableRegister:C,tableState:w,tableMethods:v}=me({fetchDataApi:()=>f(this,null,function*(){const{currentPage:a,pageSize:e}=w,t=q({page:o(a),pageSize:o(e)},o(s));t.game_name&&(t.game_code=g.value[t.game_name]);const r=yield Se(t);return r.data.list.forEach(F=>{g.value[F.gameBase.name]=F.game_code}),{list:r.data.list||[],total:r.data.total||0}}),fetchDelApi:()=>f(this,null,function*(){return!!(yield Pe(o(V)))})}),{dataList:u,loading:_,total:W,currentPage:k,pageSize:S}=w,{getList:P,getElTableExpose:X,delList:Y}=v;ye(()=>{P()});const Z=G([{field:"selection",type:"selection"},{field:"game_code",label:"游戏编号"},{field:"game_name",label:"游戏名称",slots:{default:a=>{var e;return l(R,null,[((e=a.row.gameBase)==null?void 0:e.name)||""])}}},{field:"game_code_sub",label:"房间类型id"},{field:"bet",label:"底分"},{field:"min_gold",label:"需要的最小金币"},{field:"max_gold",label:"最大金币"},{field:"name",label:"名字"},{field:"enable",label:"是否关闭",slots:{default:a=>l(R,null,[l(ve,{type:a.row.enable?"success":"danger"},{default:()=>[a.row.enable?"开启":"关闭"]})])}},{field:"desc",label:"说明"},{field:"action",label:"操作",width:180,slots:{default:a=>{const e=a.row;return l(R,null,[l(T,{content:"编辑",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>D(e,"edit")},{default:()=>[l($,{icon:"vi-mingcute:edit-line"},null)]})]}),l(T,{content:ee(e.enable),placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>te(e)},{default:()=>[l($,{icon:"vi-ep:open"},null)]})]}),l(T,{content:"删除",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>I(e)},{default:()=>[l($,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),ee=a=>a===0?"开启":"关闭",te=a=>{let e="是否关闭房间";a.enable===0&&(e="是否开启房间"),_e.confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!1}).then(()=>{const t=Object.assign({},a);t.enable=t.enable===0?1:0,ae(t)}).catch(()=>{c({type:"info",message:"取消修改状态"})})},ae=a=>f(this,null,function*(){var e;try{c({message:"正在更新状态...",type:"info",duration:0});const t=yield Q(a);if((t==null?void 0:t.code)===200)c.closeAll(),c.success("状态更新成功"),yield P();else throw new Error(((e=t==null?void 0:t.data)==null?void 0:e.message)||"更新状态失败")}catch(t){console.error("更新状态失败:",t),c.error(t.message||"更新状态失败")}}),b=m(!1),A=m(""),M=m(),x=m(""),D=(a,e)=>{A.value="编辑",x.value=e,M.value=a,b.value=!0},N=m(),z=m(!1),oe=()=>f(this,null,function*(){var e;const a=o(N);try{const t=yield a==null?void 0:a.submit();if(!t)return;z.value=!0,t.gameBase&&(t.gameBase=null),t.id||(t.enable=1),c({message:"正在保存...",type:"info",duration:0});const r=yield Q(t);if((r==null?void 0:r.code)===200)c.closeAll(),c.success("操作成功"),b.value=!1,yield P();else throw new Error(((e=r==null?void 0:r.data)==null?void 0:e.message)||"操作失败")}catch(t){console.error("操作失败:",t),c.error(t.message||"操作失败")}finally{z.value=!1}}),E=m(!1),V=m([]),I=a=>f(this,null,function*(){const e=yield X();V.value=a?[a.id]:(e==null?void 0:e.getSelectionRows().map(t=>t.id))||[],E.value=!0,yield Y(o(V).length).finally(()=>{E.value=!1})}),le=a=>{k.value=a},ne=a=>{S.value=a};return(a,e)=>(L(),we(R,null,[l(o(pe),null,{default:d(()=>[l(o(ce),{schema:i,onReset:y,onSearch:y},null,8,["schema"]),ke("div",Re,[l(o(p),{type:"primary",onClick:e[0]||(e[0]=t=>D({},"edit"))},{default:d(()=>e[6]||(e[6]=[B("新增")])),_:1}),l(o(p),{loading:E.value,type:"danger",onClick:e[1]||(e[1]=t=>I())},{default:d(()=>e[7]||(e[7]=[B(" 删除 ")])),_:1},8,["loading"])]),l(o(ue),{pageSize:o(S),"onUpdate:pageSize":[e[2]||(e[2]=t=>H(S)?S.value=t:null),ne],currentPage:o(k),"onUpdate:currentPage":[e[3]||(e[3]=t=>H(k)?k.value=t:null),le],pagination:{total:o(W)},columns:Z,data:o(u),loading:o(_),onRegister:o(C)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),l(o(ge),{modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),title:A.value},{footer:d(()=>[x.value!=="detail"?(L(),J(o(p),{key:0,type:"primary",loading:z.value,onClick:oe},{default:d(()=>e[8]||(e[8]=[B(K("保存"))])),_:1},8,["loading"])):O("",!0),l(o(p),{onClick:e[4]||(e[4]=t=>b.value=!1)},{default:d(()=>e[9]||(e[9]=[B(K("关闭"))])),_:1})]),default:d(()=>[x.value==="edit"?(L(),J(fe,{key:0,ref_key:"writeRef",ref:N,"current-row":M.value},null,8,["current-row"])):O("",!0)]),_:1},8,["modelValue","title"])],64))}}),dt=de(Be,[["__scopeId","data-v-eb1e5935"]]);export{dt as default};
