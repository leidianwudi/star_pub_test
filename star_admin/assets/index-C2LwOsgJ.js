var Z=Object.defineProperty;var T=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var A=(s,i,l)=>i in s?Z(s,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[i]=l,N=(s,i)=>{for(var l in i||(i={}))ee.call(i,l)&&A(s,l,i[l]);if(T)for(var l of T(i))te.call(i,l)&&A(s,l,i[l]);return s};var v=(s,i,l)=>new Promise((k,d)=>{var L=m=>{try{p(l.next(m))}catch(f){d(f)}},P=m=>{try{p(l.throw(m))}catch(f){d(f)}},p=m=>m.done?k(m.value):Promise.resolve(m.value).then(L,P);p((l=l.apply(s,i)).next())});import{h as b,I as F}from"./index-YGSL2gxf.js";import{_ as ae}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{u as oe}from"./useTable-YuVhaX40.js";/* empty css                   */import{_ as le}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as ie}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as ne}from"./Write.vue_vue_type_script_setup_true_lang-BV5zns7B.js";import{_ as se}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{f as re,h as me,i as ue}from"./index-D7Tnk3Vo.js";import{a3 as I,b as S}from"./element-plus-B2PLgZHf.js";import{v as ce,r as u,u as o,V as M,M as n,H as U,x as R,y as de,K as c,B as pe,a3 as V,k as W,J as G,P as H,G as J}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";/* empty css                  */const fe={class:"mb-10px"},tt=ce({__name:"index",setup(s){const i=u([]),l=u({}),{tableRegister:k,tableState:d,tableMethods:L}=oe({fetchDataApi:()=>v(this,null,function*(){const{currentPage:a,pageSize:e}=d,t=N({page:o(a),pageSize:o(e)},o(l)),r=yield re(t);return{list:r.data.list||[],total:r.data.total||0}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield me(o(i)))})}),P=M([{field:"item_code",label:"道具编号",component:"Input"}]),{dataList:p,loading:m,total:f,currentPage:_,pageSize:y}=d,{getList:$,getElTableExpose:K,delList:j}=L,q=M([{field:"selection",type:"selection"},{field:"sn",label:"序列号"},{field:"account",label:"玩家账户"},{field:"date",label:"日期"},{field:"day",label:"星期几"},{field:"item_code",label:"道具编号"},{field:"reward",label:"奖励数量"},{field:"creator_at",label:"签到日期"},{field:"desc",label:"备注"},{field:"action",label:"操作",width:180,slots:{default:a=>{const e=a.row;return n(U,null,[n(I,{content:"编辑",placement:"top"},{default:()=>[n(b,{size:"small",onClick:()=>O(e,"edit")},{default:()=>[n(F,{icon:"vi-mingcute:edit-line"},null)]})]}),n(I,{content:"删除",placement:"top"},{default:()=>[n(b,{size:"small",onClick:()=>D(e)},{default:()=>[n(F,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),g=u(!1),x=u(""),h=u(),w=u(""),O=(a,e)=>{x.value="编辑",w.value=e,h.value=a,g.value=!0},B=u(),z=u(!1),Q=()=>v(this,null,function*(){var e;const a=o(B);try{const t=yield a==null?void 0:a.submit();if(!t)return;z.value=!0,t.desc||(t.desc=""),t.id||(t.enable=1),S({message:"正在保存...",type:"info",duration:0});const r=yield ue(t);if((r==null?void 0:r.code)===200)S.closeAll(),S.success("操作成功"),g.value=!1,yield $();else throw new Error(((e=r==null?void 0:r.data)==null?void 0:e.message)||"操作失败")}catch(t){console.error("操作失败:",t),S.error(t.message||"操作失败")}finally{z.value=!1}}),C=u(!1),D=a=>v(this,null,function*(){const e=yield K();i.value=a?[a.id]:(e==null?void 0:e.getSelectionRows().map(t=>t.id))||[],C.value=!0,yield j(o(i).length).finally(()=>{C.value=!1})}),E=a=>{l.value=a,$()},X=a=>{_.value=a},Y=a=>{y.value=a};return(a,e)=>(R(),de(U,null,[n(o(ie),null,{default:c(()=>[n(o(le),{schema:P,onReset:E,onSearch:E},null,8,["schema"]),pe("div",fe,[n(o(b),{loading:C.value,type:"danger",onClick:e[0]||(e[0]=t=>D())},{default:c(()=>e[5]||(e[5]=[V("删除")])),_:1},8,["loading"])]),n(o(ae),{pageSize:o(y),"onUpdate:pageSize":[e[1]||(e[1]=t=>W(y)?y.value=t:null),Y],currentPage:o(_),"onUpdate:currentPage":[e[2]||(e[2]=t=>W(_)?_.value=t:null),X],pagination:{total:o(f)},columns:q,data:o(p),loading:o(m),onRegister:o(k)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),n(o(se),{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=t=>g.value=t),title:x.value},{footer:c(()=>[w.value!=="detail"?(R(),G(o(b),{key:0,type:"primary",loading:z.value,onClick:Q},{default:c(()=>e[6]||(e[6]=[V(H("保存"))])),_:1},8,["loading"])):J("",!0),n(o(b),{onClick:e[3]||(e[3]=t=>g.value=!1)},{default:c(()=>e[7]||(e[7]=[V(H("关闭"))])),_:1})]),default:c(()=>[w.value==="edit"||w.value==="add"?(R(),G(ne,{key:0,ref_key:"writeRef",ref:B,"current-row":h.value},null,8,["current-row"])):J("",!0)]),_:1},8,["modelValue","title"])],64))}});export{tt as default};
