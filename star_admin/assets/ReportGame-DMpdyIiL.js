var x=(D,d,c)=>new Promise((_,y)=>{var r=o=>{try{m(c.next(o))}catch(f){y(f)}},w=o=>{try{m(c.throw(o))}catch(f){y(f)}},m=o=>o.done?_(o.value):Promise.resolve(o.value).then(r,w);m((c=c.apply(D,d)).next())});import{u as E}from"./useTable-Upa2w_0L.js";import{c as G,u as L}from"./index-CHi5EjGf.js";import{_ as $}from"./Search.vue_vue_type_script_setup_true_lang-8pn9kdmB.js";import{_ as B}from"./ContentWrap.vue_vue_type_script_setup_true_lang-3Xc5l_op.js";import{g as R,a as I,b as F,c as K}from"./index-CsFdu-eY.js";/* empty css               *//* empty css                *//* empty css                         */import{_ as N}from"./Echart.vue_vue_type_script_setup_true_lang-BDMyYecZ.js";import{u as O,t as Y,r as j,s as V,v as u}from"./element-plus-B2PLgZHf.js";import{v as q,c as z,r as v,V as A,w as H,j as J,u as n,x as Q,y as U,M as l,K as g}from"./vue-chunks-COp0tDkU.js";import"./Form-gS9_0x15.js";/* empty css                     *//* empty css                  *//* empty css               *//* empty css                    */import"./el-radio-button-BHRYMbwi.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-BYoZN2oo.js";import"./style.css_vue_type_style_index_0_src_true_lang-C48CRznB.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D8LijxOC.js";import"./IconPicker-BRysFjva.js";/* empty css                      */import"./IAgree.vue_vue_type_script_setup_true_lang-SWoxqzUy.js";import"./Highlight.vue_vue_type_script_lang-DCoMisvs.js";import"./useForm-D3UcvRwb.js";import"./useIcon-twKurrFj.js";import"./echarts-whH8FFdn.js";const W={title:{text:"每日游戏统计表",left:"center"},xAxis:{data:[],boundaryGap:!1,axisTick:{show:!1}},grid:{left:20,right:20,bottom:20,top:80,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:[],top:50},series:[]},X={class:"flex w-100% h-100%"},Le=q({__name:"ReportGame",setup(D){const{t:d}=G(),c=L(),_=z(()=>c.getIsDark),y=v(!0),r=A(W),w=e=>{const a=["cost","win","final","play_num","room_num","rtp","rtp_big"],t=["花费","奖励","结果","玩次数","房间数","普通rtp","幸运时刻rtp"];if(e&&e.code===200){const s=[];for(let p=0;p<a.length;p++){const b={name:t[p],smooth:!0,type:"line",data:e.data.list.map(C=>C[a[p]]),animationDuration:2800,animationEasing:"quadraticOut"};s.push(b)}u(r,"xAxis.data",e.data.list.map(p=>new Date(p.day).getDate())),u(r,"legend.data",t),u(r,"series",s)}},m=e=>{const a={color:_.value?"#ccc":"#333"},t=_.value?"#abacac":"#ccc";u(e,"title.textStyle",a),u(e,"legend.textStyle",a),u(e,"legend.inactiveColor",t)};H(_,()=>{m(r)}),J(()=>{m(r)});const o=v({}),{tableState:f,tableMethods:k}=E({fetchDataApi:()=>x(this,null,function*(){const{currentPage:e,pageSize:a}=f;let t={};return i.value&&i.value.game_code||i.value.day_min||i.value.type_code?t=yield R(n(e),n(a),i.value):(t=yield I(M()),t.data.list.forEach(s=>{s&&s.gameBase&&(o.value[d(s.gameBase.name)]=s.game_code)})),w(t),y.value=!1,{list:t.data.list||[],total:t.data.total||0}})}),M=()=>{const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(e.getFullYear(),e.getMonth()+1,0);return{day_min:h(a),day_max:h(t)}},{getList:P}=k,T=A([{field:"name",label:"游戏名称",component:"Select",componentProps:{nodeKey:"name",props:{label:e=>{if(e&&e.name)return d(e.name)},value:"name"},checkStrictly:!0},optionApi:()=>x(this,null,function*(){return(yield F()).data.list||[]})},{field:"type_code",label:"游戏类型",component:"Select",componentProps:{nodeKey:"type_code",props:{label:e=>{if(e&&e.type_code)return d(e.type_code)},value:"type_code"},checkStrictly:!0},optionApi:()=>x(this,null,function*(){return(yield K()).data.list||[]})},{field:"day_min",label:"起始时间",component:"DatePicker"},{field:"day_max",label:"结束时间",component:"DatePicker"}]),i=v({}),S=e=>{e&&(e.day_min||e.name)?(e.day_max||(e.day_max=e.day_min),i.value=e.day_min?{type_code:e.type_code,game_code:o.value[e.name],day_min:h(new Date(e.day_min)),day_max:h(new Date(e.day_max))}:{type_code:e.type_code,game_code:o.value[e.name]}):i.value=e,P()},h=e=>{const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${a}-${t}-${s}`};return(e,a)=>(Q(),U("div",X,[l(n(B),{class:"flex-[3] ml-20px"},{default:g(()=>[l(n($),{schema:T,onReset:S,onSearch:S},null,8,["schema"]),l(n(O),{gutter:20,justify:"space-between"},{default:g(()=>[l(n(Y),{span:24},{default:g(()=>[l(n(j),{shadow:"hover",class:"mb-20px"},{default:g(()=>[l(n(V),{loading:y.value,animated:"",rows:4},{default:g(()=>[l(n(N),{options:r,height:350},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{Le as default};
