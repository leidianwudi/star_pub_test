var ae=Object.defineProperty;var M=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var N=(s,i,n)=>i in s?ae(s,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[i]=n,F=(s,i)=>{for(var n in i||(i={}))oe.call(i,n)&&N(s,n,i[n]);if(M)for(var n of M(i))le.call(i,n)&&N(s,n,i[n]);return s};var v=(s,i,n)=>new Promise((S,y)=>{var C=u=>{try{b(n.next(u))}catch(d){y(d)}},x=u=>{try{b(n.throw(u))}catch(d){y(d)}},b=u=>u.done?S(u.value):Promise.resolve(u.value).then(C,x);b((n=n.apply(s,i)).next())});import{h as p,I as B}from"./index-YGSL2gxf.js";import{_ as ne}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{u as ie}from"./useTable-YuVhaX40.js";/* empty css               *//* empty css                   */import{_ as se}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as re}from"./Write.vue_vue_type_script_setup_true_lang-Pf1KM9UA.js";import{_ as ue}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{g as ce,d as me,u as U}from"./index-D7Tnk3Vo.js";import{n as de,a3 as E,k as pe,b as c}from"./element-plus-B2PLgZHf.js";import{v as fe,r as m,u as o,V as h,M as l,H as R,x as T,y as ge,K as f,B as ve,a3 as k,P as L,k as j,J as G,G as H}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";/* empty css                  */const ye={class:"mb-10px"},at=fe({__name:"index",setup(s){const i=m([]),n=m({}),{tableRegister:S,tableState:y,tableMethods:C}=ie({fetchDataApi:()=>v(this,null,function*(){const{currentPage:a,pageSize:e}=y,t=F({page:o(a),pageSize:o(e)},o(n)),r=yield ce(t);return{list:r.data.list||[],total:r.data.total||0}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield me(o(i)))})});h([{field:"item_code",label:"道具编号",component:"Input"}]);const{dataList:x,loading:b,total:u,currentPage:d,pageSize:_}=y,{getList:$,getElTableExpose:J,delList:K}=C,O=h([{field:"selection",type:"selection"},{field:"item_code",label:"道具编号"},{field:"item_name",label:"道具名称"},{field:"enable",label:"是否起效",slots:{default:a=>l(R,null,[l(de,{type:a.row.enable?"success":"danger"},{default:()=>[a.row.enable?"开启":"关闭"]})])}},{field:"desc",label:"备注"},{field:"action",label:"操作",width:180,slots:{default:a=>{const e=a.row;return l(R,null,[l(E,{content:"编辑",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>X(e,"edit")},{default:()=>[l(B,{icon:"vi-mingcute:edit-line"},null)]})]}),l(E,{content:q(e.enable),placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>Q(e)},{default:()=>[l(B,{icon:"vi-ep:open"},null)]})]}),l(E,{content:"删除",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>D(e)},{default:()=>[l(B,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),q=a=>a===0?"开启":"关闭",Q=a=>{let e="是否关闭";a.enable===0&&(e="是否开启"),pe.confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!1}).then(()=>{const t=Object.assign({},a);t.enable=t.enable===0?1:0,W(t)}).catch(()=>{c({type:"info",message:"取消修改状态"})})},W=a=>v(this,null,function*(){var e;try{c({message:"正在更新状态...",type:"info",duration:0});const t=yield U(a);if((t==null?void 0:t.code)===200)c.closeAll(),c.success("状态更新成功"),yield $();else throw new Error(((e=t==null?void 0:t.data)==null?void 0:e.message)||"更新状态失败")}catch(t){console.error("更新状态失败:",t),c.error(t.message||"更新状态失败")}}),g=m(!1),z=m(""),A=m(),w=m(""),X=(a,e)=>{z.value="编辑",w.value=e,A.value=a,g.value=!0},I=m(),P=m(!1),Y=()=>v(this,null,function*(){var e;const a=o(I);try{const t=yield a==null?void 0:a.submit();if(!t)return;P.value=!0,t.desc||(t.desc=""),t.id||(t.enable=1),c({message:"正在保存...",type:"info",duration:0});const r=yield U(t);if((r==null?void 0:r.code)===200)c.closeAll(),c.success("操作成功"),g.value=!1,yield $();else throw new Error(((e=r==null?void 0:r.data)==null?void 0:e.message)||"操作失败")}catch(t){console.error("操作失败:",t),c.error(t.message||"操作失败")}finally{P.value=!1}}),V=m(!1),D=a=>v(this,null,function*(){const e=yield J();i.value=a?[a.id]:(e==null?void 0:e.getSelectionRows().map(t=>t.id))||[],V.value=!0,yield K(o(i).length).finally(()=>{V.value=!1})}),Z=()=>{z.value="新增",A.value=void 0,g.value=!0,w.value="add"},ee=a=>{d.value=a},te=a=>{_.value=a};return(a,e)=>(T(),ge(R,null,[l(o(se),null,{default:f(()=>[ve("div",ye,[l(o(p),{type:"primary",onClick:Z},{default:f(()=>e[5]||(e[5]=[k(L("新增"))])),_:1}),l(o(p),{loading:V.value,type:"danger",onClick:e[0]||(e[0]=t=>D())},{default:f(()=>e[6]||(e[6]=[k("删除")])),_:1},8,["loading"])]),l(o(ne),{pageSize:o(_),"onUpdate:pageSize":[e[1]||(e[1]=t=>j(_)?_.value=t:null),te],currentPage:o(d),"onUpdate:currentPage":[e[2]||(e[2]=t=>j(d)?d.value=t:null),ee],pagination:{total:o(u)},columns:O,data:o(x),loading:o(b),onRegister:o(S)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),l(o(ue),{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=t=>g.value=t),title:z.value},{footer:f(()=>[w.value!=="detail"?(T(),G(o(p),{key:0,type:"primary",loading:P.value,onClick:Y},{default:f(()=>e[7]||(e[7]=[k(L("保存"))])),_:1},8,["loading"])):H("",!0),l(o(p),{onClick:e[3]||(e[3]=t=>g.value=!1)},{default:f(()=>e[8]||(e[8]=[k(L("关闭"))])),_:1})]),default:f(()=>[w.value==="edit"||w.value==="add"?(T(),G(re,{key:0,ref_key:"writeRef",ref:I,"current-row":A.value},null,8,["current-row"])):H("",!0)]),_:1},8,["modelValue","title"])],64))}});export{at as default};
