var h=(D,_,m)=>new Promise((y,g)=>{var k=l=>{try{u(m.next(l))}catch(r){g(r)}},w=l=>{try{u(m.throw(l))}catch(r){g(r)}},u=l=>l.done?y(l.value):Promise.resolve(l.value).then(k,w);u((m=m.apply(D,_)).next())});import{u as W}from"./useTable-YuVhaX40.js";import{c as X,h as C}from"./index-YGSL2gxf.js";import{_ as Z}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{_ as ee}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as ae}from"./Write.vue_vue_type_script_setup_true_lang-CbfxE3A7.js";import{_ as oe}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{n as L,o as le}from"./index-DOJE_sUj.js";import{v as se,u as t,V as M,r as n,j as re,x as P,y as ie,M as f,K as d,k as A,J as B,a3 as F,P as U,G as E}from"./vue-chunks-COp0tDkU.js";import"./element-plus-B2PLgZHf.js";/* empty css                    *//* empty css                   *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./useValidator-DY0gbKVw.js";/* empty css                  */const ne={class:"flex w-100% h-100%"},Xe=se({__name:"ReportPerson",setup(D){const{t:_}=X(),{tableRegister:m,tableState:y,tableMethods:g}=W({fetchDataApi:()=>h(this,null,function*(){const{currentPage:e,pageSize:a}=y;let o={};return p.value&&(p.value.account||p.value.day_min)?o=yield L(t(e),t(a),p.value):o=yield L(t(e),t(a)),{list:o.data.list||[],total:o.data.total||0}})}),{dataList:k,loading:w,total:u,currentPage:l,pageSize:r}=y,{getList:G}=g,I=M([{field:"day",label:"日期"},{field:"account",label:"玩家账号"},{field:"slots_cost",label:"slots花费"},{field:"slots_win",label:"slots奖励"},{field:"slots_final",label:"slots结果"},{field:"slots_play_num",label:"slots玩次数"},{field:"poker_cost",label:"poker花费"},{field:"poker_win",label:"poker奖励"},{field:"poker_final",label:"poker结果"},{field:"poker_play_num",label:"poker玩次数"},{field:"fish_cost",label:"捕鱼花费"},{field:"fish_win",label:"捕鱼奖励"},{field:"fish_final",label:"捕鱼结果"},{field:"fish_play_num",label:"捕鱼玩次数"}]),j=M([{field:"account",label:"账号",component:"Input"},{field:"day_min",label:"起始时间",component:"DatePicker"},{field:"day_max",label:"结束时间",component:"DatePicker"}]),p=n({}),R=e=>{e&&(e.account||e.day_min)?(e.day_max||(e.day_max=e.day_min),p.value=e.day_min?{account:e.account,day_min:N(new Date(e.day_min)),day_max:N(new Date(e.day_max))}:{account:e.account}):p.value=e,G()},N=e=>{const a=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${a}-${o}-${s}`},S=n(!1),J=n(""),K=n(),x=n(""),$=n(),T=n(!1),Y=()=>h(this,null,function*(){const e=t($);(yield e==null?void 0:e.submit())&&(T.value=!0)}),q=e=>{l.value=e},H=e=>{r.value=e},O=e=>{const{columns:a,data:o}=e,s=[];return a.forEach((b,i)=>{if(i===0){s[i]="总计";return}if(["slots_cost","slots_win","slots_final","slots_play_num","poker_cost","poker_win","poker_final","poker_play_num","fish_cost","fish_win","fish_final","fish_play_num"].includes(b.property))if(v.value&&v.value.list[0][b.property]!==void 0)s[i]=Number(v.value.list[0][b.property]).toFixed(2);else{const V=e.data.map(c=>Number(c[b.property]));V.every(c=>isNaN(c))?s[i]="N/A":(s[i]=V.reduce((c,Q)=>{const z=Number(Q);return isNaN(z)?c:c+z},0),s[i]=s[i].toFixed(2))}else s[i]=""}),s},v=n(null);return re(()=>h(this,null,function*(){try{const e=yield le();v.value=e.data}catch(e){console.error("获取游戏报表总计数据失败:",e)}})),(e,a)=>(P(),ie("div",ne,[f(t(te),{class:"flex-[3] ml-20px"},{default:d(()=>[f(t(ee),{schema:j,onReset:R,onSearch:R},null,8,["schema"]),f(t(Z),{pageSize:t(r),"onUpdate:pageSize":[a[0]||(a[0]=o=>A(r)?r.value=o:null),H],currentPage:t(l),"onUpdate:currentPage":[a[1]||(a[1]=o=>A(l)?l.value=o:null),q],pagination:{total:t(u)},"tree-props":{children:"children"},columns:I,"default-expand-all":"","node-key":"id",data:t(k),loading:t(w),onRegister:t(m),"show-summary":"","summary-method":O},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),f(t(oe),{modelValue:S.value,"onUpdate:modelValue":a[3]||(a[3]=o=>S.value=o),title:J.value},{footer:d(()=>[x.value!=="detail"?(P(),B(t(C),{key:0,type:"primary",loading:T.value,onClick:Y},{default:d(()=>[F(U(t(_)("exampleDemo.save")),1)]),_:1},8,["loading"])):E("",!0),f(t(C),{onClick:a[2]||(a[2]=o=>S.value=!1)},{default:d(()=>[F(U(t(_)("dialogDemo.close")),1)]),_:1})]),default:d(()=>[x.value!=="detail"?(P(),B(ae,{key:0,ref_key:"writeRef",ref:$,"current-row":K.value},null,8,["current-row"])):E("",!0)]),_:1},8,["modelValue","title"])]))}});export{Xe as default};
