var oe=Object.defineProperty;var M=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var I=(i,s,n)=>s in i?oe(i,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[s]=n,N=(i,s)=>{for(var n in s||(s={}))le.call(s,n)&&I(i,n,s[n]);if(M)for(var n of M(s))ne.call(s,n)&&I(i,n,s[n]);return i};var f=(i,s,n)=>new Promise((b,_)=>{var w=m=>{try{g(n.next(m))}catch(v){_(v)}},z=m=>{try{g(n.throw(m))}catch(v){_(v)}},g=m=>m.done?b(m.value):Promise.resolve(m.value).then(w,z);g((n=n.apply(i,s)).next())});import{u as se}from"./useTable-YuVhaX40.js";import{_ as ie}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{_ as re}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as me}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{h as p,I as B,_ as ue}from"./index-YGSL2gxf.js";/* empty css                   *//* empty css               */import{_ as ce}from"./Write.vue_vue_type_script_setup_true_lang-BaPzgbHh.js";import{_ as pe}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{g as de,d as fe,u as F}from"./index-BU1Y4vql.js";import{n as ge,a3 as E,k as ve,b as u}from"./element-plus-B2PLgZHf.js";import{v as ye,V as U,r as c,u as o,j as be,M as l,H as T,x as A,y as _e,K as d,B as we,a3 as x,k as j,J as H,P as J,G as K}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./index-DOJE_sUj.js";/* empty css                  */const ke={class:"mb-10px"},Se=ye({__name:"GameOdds",setup(i){const s=U([{field:"game_type_code",label:"游戏类型",component:"Input"}]),n=c({}),b=a=>{n.value=a,C()},{tableRegister:_,tableState:w,tableMethods:z}=se({fetchDataApi:()=>f(this,null,function*(){const{currentPage:a,pageSize:e}=w,t=N({page:o(a),pageSize:o(e)},o(n)),r=yield de(t);return{list:r.data.list||[],total:r.data.total||0}}),fetchDelApi:()=>f(this,null,function*(){return!!(yield fe(o($)))})}),{dataList:g,loading:m,total:v,currentPage:k,pageSize:S}=w,{getList:C,getElTableExpose:q,delList:Q}=z;be(()=>{C()});const W=U([{field:"selection",type:"selection"},{field:"game_type_code",label:"游戏类型"},{field:"type_name",label:"类型名称",slots:{default:a=>{var e;return l(T,null,[((e=a.row.gameType)==null?void 0:e.type_name)||""])}}},{field:"sort",label:"排序"},{field:"odds_key",label:"概率key"},{field:"odds_value",label:"概率值"},{field:"enable",label:"是否起效",slots:{default:a=>l(T,null,[l(ge,{type:a.row.enable?"success":"danger"},{default:()=>[a.row.enable?"开启":"关闭"]})])}},{field:"desc",label:"说明"},{field:"action",label:"操作",width:180,slots:{default:a=>{const e=a.row;return l(T,null,[l(E,{content:"编辑",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>O(e,"edit")},{default:()=>[l(B,{icon:"vi-mingcute:edit-line"},null)]})]}),l(E,{content:X(e.enable),placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>Y(e)},{default:()=>[l(B,{icon:"vi-ep:open"},null)]})]}),l(E,{content:"删除",placement:"top"},{default:()=>[l(p,{size:"small",onClick:()=>D(e)},{default:()=>[l(B,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),X=a=>a===0?"开启":"关闭",Y=a=>{let e="是否关闭概率";a.enable===0&&(e="是否开启概率"),ve.confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!1}).then(()=>{const t=Object.assign({},a);t.enable=t.enable===0?1:0,Z(t)}).catch(()=>{u({type:"info",message:"取消修改状态"})})},Z=a=>f(this,null,function*(){var e;try{u({message:"正在更新状态...",type:"info",duration:0});const t=yield F(a);if((t==null?void 0:t.code)===200)u.closeAll(),u.success("状态更新成功"),yield C();else throw new Error(((e=t==null?void 0:t.data)==null?void 0:e.message)||"更新状态失败")}catch(t){console.error("更新状态失败:",t),u.error(t.message||"更新状态失败")}}),y=c(!1),G=c(""),L=c(),P=c(""),O=(a,e)=>{G.value="编辑",P.value=e,L.value=a,y.value=!0},h=c(),R=c(!1),ee=()=>f(this,null,function*(){var e;const a=o(h);try{const t=yield a==null?void 0:a.submit();if(!t)return;R.value=!0,t.gameType&&(t.gameType=null),u({message:"正在保存...",type:"info",duration:0});const r=yield F(t);if((r==null?void 0:r.code)===200)u.closeAll(),u.success("操作成功"),y.value=!1,yield C();else throw new Error(((e=r==null?void 0:r.data)==null?void 0:e.message)||"操作失败")}catch(t){console.error("操作失败:",t),u.error(t.message||"操作失败")}finally{R.value=!1}}),V=c(!1),$=c([]),D=a=>f(this,null,function*(){const e=yield q();$.value=a?[a.id]:(e==null?void 0:e.getSelectionRows().map(t=>t.id))||[],V.value=!0,yield Q(o($).length).finally(()=>{V.value=!1})}),te=a=>{k.value=a},ae=a=>{S.value=a};return(a,e)=>(A(),_e(T,null,[l(o(me),null,{default:d(()=>[l(o(re),{schema:s,onReset:b,onSearch:b},null,8,["schema"]),we("div",ke,[l(o(p),{type:"primary",onClick:e[0]||(e[0]=t=>O({},"edit"))},{default:d(()=>e[6]||(e[6]=[x("新增")])),_:1}),l(o(p),{loading:V.value,type:"danger",onClick:e[1]||(e[1]=t=>D())},{default:d(()=>e[7]||(e[7]=[x(" 删除 ")])),_:1},8,["loading"])]),l(o(ie),{pageSize:o(S),"onUpdate:pageSize":[e[2]||(e[2]=t=>j(S)?S.value=t:null),ae],currentPage:o(k),"onUpdate:currentPage":[e[3]||(e[3]=t=>j(k)?k.value=t:null),te],pagination:{total:o(v)},columns:W,data:o(g),loading:o(m),onRegister:o(_)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),l(o(pe),{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=t=>y.value=t),title:G.value},{footer:d(()=>[P.value!=="detail"?(A(),H(o(p),{key:0,type:"primary",loading:R.value,onClick:ee},{default:d(()=>e[8]||(e[8]=[x(J("保存"))])),_:1},8,["loading"])):K("",!0),l(o(p),{onClick:e[4]||(e[4]=t=>y.value=!1)},{default:d(()=>e[9]||(e[9]=[x(J("关闭"))])),_:1})]),default:d(()=>[P.value==="edit"?(A(),H(ce,{key:0,ref_key:"writeRef",ref:h,"current-row":L.value},null,8,["current-row"])):K("",!0)]),_:1},8,["modelValue","title"])],64))}}),ut=ue(Se,[["__scopeId","data-v-fb13c468"]]);export{ut as default};
