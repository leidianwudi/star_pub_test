var te=Object.defineProperty;var q=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var G=(l,i,s)=>i in l?te(l,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[i]=s,H=(l,i)=>{for(var s in i||(i={}))le.call(i,s)&&G(l,s,i[s]);if(q)for(var s of q(i))ae.call(i,s)&&G(l,s,i[s]);return l};var v=(l,i,s)=>new Promise((C,p)=>{var L=u=>{try{f(s.next(u))}catch(g){p(g)}},P=u=>{try{f(s.throw(u))}catch(g){p(g)}},f=u=>u.done?C(u.value):Promise.resolve(u.value).then(L,P);f((s=s.apply(l,i)).next())});import{r as I,h as d,I as x}from"./index-YGSL2gxf.js";import{_ as oe}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{u as ne}from"./useTable-YuVhaX40.js";/* empty css               *//* empty css                   */import{_ as se}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as ie}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as re}from"./Write.vue_vue_type_script_setup_true_lang-B8gYGeTp.js";import{_ as ue}from"./Detail.vue_vue_type_script_setup_true_lang-D00vMQDM.js";import{_ as ce}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{n as J,a3 as E,b as S}from"./element-plus-B2PLgZHf.js";import{v as de,r as c,u as n,V as K,M as o,H as k,x as z,y as me,K as m,B as pe,a3 as B,k as j,J as T,P as O,G as D}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./Descriptions-CGScbuMD.js";/* empty css                  */const fe=l=>I.post({url:"/slots_log/select",data:{page:l.page,pageNum:l.pageSize,sn:l.sn,game_code:l.game_code,user_account:l.user_account}}),ge=l=>I.post({url:"/slots_log/update",data:l}),_e=l=>I.post({url:"/slots_log/delete",data:{ids:l}}),ve={class:"mb-10px"},nt=de({__name:"SlotLog",setup(l){const i=c([]),s=c({}),{tableRegister:C,tableState:p,tableMethods:L}=ne({fetchDataApi:()=>v(this,null,function*(){const{currentPage:t,pageSize:e}=p,a=H({page:n(t),pageSize:n(e)},n(s)),r=yield fe(a);return{list:r.data.list||[],total:r.data.total||0}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield _e(n(i)))})}),P=K([{field:"sn",label:"订单号",component:"Input"},{field:"user_account",label:"用户",component:"Input"},{field:"game_code",label:"游戏编号",component:"Input"}]),{dataList:f,loading:u,total:g,currentPage:b,pageSize:y}=p,{getList:N,getElTableExpose:Q,delList:W}=L,X=K([{field:"selection",type:"selection"},{field:"sn",label:"订单号"},{field:"sn_ext",label:"关联订单号"},{field:"user_account",label:"用户"},{field:"game_code",label:"游戏编号"},{field:"game_name",label:"游戏名称"},{field:"room_id",label:"房间id"},{field:"type",label:"类型",slots:{default:t=>o(k,null,[o(J,{type:t.row.type===0?"danger":"success"},{default:()=>[t.row.type===0?"未中":"中奖"]})])}},{field:"is_lucky",label:"是否幸运事件",slots:{default:t=>o(k,null,[o(J,{type:t.row.is_lucky===0?"danger":"success"},{default:()=>[t.row.is_lucky?"是":"否"]})])}},{field:"spend",label:"花费"},{field:"win",label:"赢得"},{field:"final",label:"最终赢得"},{field:"create_at",label:"时间"},{field:"contents",label:"结果内容"},{field:"desc",label:"备注"},{field:"action",label:"操作",width:180,slots:{default:t=>{const e=t.row;return o(k,null,[o(E,{content:"编辑",placement:"top"},{default:()=>[o(d,{size:"small",onClick:()=>A(e,"edit")},{default:()=>[o(x,{icon:"vi-mingcute:edit-line"},null)]})]}),o(E,{content:"详情",placement:"top"},{default:()=>[o(d,{size:"small",onClick:()=>A(e,"detail")},{default:()=>[o(x,{icon:"vi-bx:detail"},null)]})]}),o(E,{content:"删除",placement:"top"},{default:()=>[o(d,{size:"small",onClick:()=>M(e)},{default:()=>[o(x,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),_=c(!1),h=c(""),R=c(),w=c(""),A=(t,e)=>{h.value=e==="edit"?"编辑":"详情",w.value=e,R.value=t,_.value=!0},F=c(),V=c(!1),Y=()=>v(this,null,function*(){var e;const t=n(F);try{const a=yield t==null?void 0:t.submit();if(!a)return;V.value=!0,a.desc||(a.desc=""),S({message:"正在保存...",type:"info",duration:0});const r=yield ge(a);if((r==null?void 0:r.code)===200)S.closeAll(),S.success("操作成功"),_.value=!1,yield N();else throw new Error(((e=r==null?void 0:r.data)==null?void 0:e.message)||"操作失败")}catch(a){console.error("操作失败:",a),S.error(a.message||"操作失败")}finally{V.value=!1}}),$=c(!1),M=t=>v(this,null,function*(){const e=yield Q();i.value=t?[t.id]:(e==null?void 0:e.getSelectionRows().map(a=>a.id))||[],$.value=!0,yield W(n(i).length).finally(()=>{$.value=!1})}),U=t=>{s.value=t,N()},Z=t=>{b.value=t},ee=t=>{y.value=t};return(t,e)=>(z(),me(k,null,[o(n(ie),null,{default:m(()=>[o(n(se),{schema:P,onReset:U,onSearch:U},null,8,["schema"]),pe("div",ve,[o(n(d),{loading:$.value,type:"danger",onClick:e[0]||(e[0]=a=>M())},{default:m(()=>e[5]||(e[5]=[B("删除")])),_:1},8,["loading"])]),o(n(oe),{pageSize:n(y),"onUpdate:pageSize":[e[1]||(e[1]=a=>j(y)?y.value=a:null),ee],currentPage:n(b),"onUpdate:currentPage":[e[2]||(e[2]=a=>j(b)?b.value=a:null),Z],pagination:{total:n(g)},columns:X,data:n(f),loading:n(u),onRegister:n(C)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),o(n(ce),{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value=a),title:h.value},{footer:m(()=>[w.value!=="detail"?(z(),T(n(d),{key:0,type:"primary",loading:V.value,onClick:Y},{default:m(()=>e[6]||(e[6]=[B(O("保存"))])),_:1},8,["loading"])):D("",!0),o(n(d),{onClick:e[3]||(e[3]=a=>_.value=!1)},{default:m(()=>e[7]||(e[7]=[B(O("关闭"))])),_:1})]),default:m(()=>[w.value==="edit"?(z(),T(re,{key:0,ref_key:"writeRef",ref:F,"current-row":R.value},null,8,["current-row"])):D("",!0),w.value==="detail"?(z(),T(ue,{key:1,"current-row":R.value},null,8,["current-row"])):D("",!0)]),_:1},8,["modelValue","title"])],64))}});export{nt as default};
