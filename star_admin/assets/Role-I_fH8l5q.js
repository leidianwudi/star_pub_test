var w=(V,a,m)=>new Promise((x,d)=>{var f=i=>{try{g(m.next(i))}catch(n){d(n)}},R=i=>{try{g(m.throw(i))}catch(n){d(n)}},g=i=>i.done?x(i.value):Promise.resolve(i.value).then(f,R);g((m=m.apply(V,a)).next())});import{d as q,b as Q,c as X,u as Y}from"./index-BlidykIS.js";import{u as Z}from"./useTable-DohiMS5o.js";import{h as y,I as $,c as ee}from"./index-Dg16wPeM.js";import{_ as ae}from"./Table.vue_vue_type_script_lang-B7JZHcWZ.js";/* empty css               *//* empty css                  */import{_ as te}from"./Search.vue_vue_type_script_setup_true_lang-VcwLHU14.js";import{_ as oe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BSoUUQnL.js";import{_ as le}from"./Write.vue_vue_type_script_setup_true_lang-Ce3Gb6sz.js";import{_ as se}from"./Detail.vue_vue_type_script_setup_true_lang-BwSpIk39.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-DhfduvPq.js";import{n as ne,a3 as A,k as re,b as h}from"./element-plus-B2PLgZHf.js";import{v as me,r,V as E,M as s,H as N,x as D,y as ue,K as p,u as o,B as ce,a3 as C,P,k as M,J as T,G as pe}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Dby5emit.js";/* empty css                         *//* empty css                  */import"./index-y8XvmqNS.js";import"./Form-BSQhYHrI.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-DnUzEfZp.js";import"./style.css_vue_type_style_index_0_src_true_lang-zYImHsie.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-CETukC1m.js";import"./IconPicker-g7mhPobf.js";import"./IAgree.vue_vue_type_script_setup_true_lang-DsjjMfNO.js";import"./Highlight.vue_vue_type_script_lang-CytUL3R8.js";import"./useForm-D392SAX5.js";import"./useIcon-DpXlt4U3.js";import"./useValidator-Dq57AcmW.js";import"./index-3RYyRJDf.js";import"./tree-Dgaev6Pi.js";import"./Descriptions-CZirfgGQ.js";/* empty css                  */const de={class:"mb-10px"},sa=me({__name:"Role",setup(V){const{t:a}=ee(),m=r({}),{tableRegister:x,tableState:d,tableMethods:f}=Z({fetchDataApi:()=>w(this,null,function*(){const{pageSize:e,currentPage:t}=d;let l={};return v.value&&v.value.id?l=yield Q(v.value.id):l=yield X(o(t),o(e)),l.data.list.forEach(L=>{m.value[L.role]=L.id}),{list:l.data.list||[],total:l.data.total}})}),{dataList:R,loading:g,total:i,pageSize:n,currentPage:b}=d,{getList:I}=f,F=E([{field:"role",label:a("role.roleName")},{field:"status",label:a("menu.status"),slots:{default:e=>s(N,null,[s(ne,{type:e.row.status===0?"danger":"success"},{default:()=>[e.row.status===1?a("userDemo.enable"):a("userDemo.disable")]})])}},{field:"create_at",label:a("tableDemo.displayTime")},{field:"remark",label:a("userDemo.remark")},{field:"action",label:a("userDemo.action"),width:120,slots:{default:e=>{const t=e.row;return s(N,null,[s(A,{content:"编辑",placement:"top"},{default:()=>[s(y,{size:"small",onClick:()=>O(t,"edit")},{default:()=>[s($,{icon:"vi-mingcute:edit-line"},null)]})]}),s(A,{content:"删除",placement:"top"},{default:()=>[s(y,{size:"small",onClick:()=>{J(t)}},{default:()=>[s($,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),U=E([{field:"roleName",label:a("role.roleName"),component:"Input"}]),v=r({}),z=e=>{if(e&&e.roleName){const t=e.roleName;v.value={id:m.value[t]}}else v.value=e;I()},u=r(!1),k=r(""),_=r(),c=r(""),B=r(),S=r(!1),O=(e,t)=>{k.value=a("exampleDemo.edit"),c.value=t,_.value=e,u.value=!0},G=()=>{k.value=a("exampleDemo.add"),_.value=void 0,u.value=!0,c.value=""},H=()=>w(this,null,function*(){const e=o(B),t=yield e==null?void 0:e.submit();if(t){S.value=!0;const l=yield Y(t);l&&l.code===200&&(S.value=!1,u.value=!1,f.getList(),h({message:c.value==="edit"?"修改成功":"添加成功",type:"success"}))}}),J=e=>{k.value=a("exampleDemo.del"),c.value="",_.value=e,re.confirm(a("common.delMessage"),a("common.delWarning"),{confirmButtonText:a("common.delOk"),cancelButtonText:a("common.delCancel"),type:"warning",center:!1}).then(()=>{K(e.id)}).catch(()=>{h({type:"info",message:"Delete canceled"})})},K=e=>w(this,null,function*(){e&&(yield q({ids:e})).code===200&&(f.getList(),h({type:"success",message:a("common.delSuccess")}))}),W=e=>{b.value=e},j=e=>{n.value=e};return(e,t)=>(D(),ue(N,null,[s(o(oe),null,{default:p(()=>[s(o(te),{schema:U,onReset:z,onSearch:z},null,8,["schema"]),ce("div",de,[s(o(y),{type:"primary",onClick:G},{default:p(()=>[C(P(o(a)("exampleDemo.add")),1)]),_:1})]),s(o(ae),{pageSize:o(n),"onUpdate:pageSize":[t[0]||(t[0]=l=>M(n)?n.value=l:null),j],currentPage:o(b),"onUpdate:currentPage":[t[1]||(t[1]=l=>M(b)?b.value=l:null),W],columns:F,"default-expand-all":"","node-key":"id",data:o(R),loading:o(g),pagination:{total:o(i)},onRegister:o(x)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),s(o(ie),{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=l=>u.value=l),title:k.value},{footer:p(()=>[c.value!=="detail"?(D(),T(o(y),{key:0,type:"primary",loading:S.value,onClick:H},{default:p(()=>[C(P(o(a)("exampleDemo.save")),1)]),_:1},8,["loading"])):pe("",!0),s(o(y),{onClick:t[2]||(t[2]=l=>u.value=!1)},{default:p(()=>[C(P(o(a)("dialogDemo.close")),1)]),_:1})]),default:p(()=>[c.value!=="detail"?(D(),T(le,{key:0,ref_key:"writeRef",ref:B,"current-row":_.value},null,8,["current-row"])):(D(),T(se,{key:1,"current-row":_.value},null,8,["current-row"]))]),_:1},8,["modelValue","title"])],64))}});export{sa as default};
