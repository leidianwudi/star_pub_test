var se=Object.defineProperty;var U=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var j=(n,r,s)=>r in n?se(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,q=(n,r)=>{for(var s in r||(r={}))re.call(r,s)&&j(n,s,r[s]);if(U)for(var s of U(r))ie.call(r,s)&&j(n,s,r[s]);return n};var p=(n,r,s)=>new Promise((y,g)=>{var x=u=>{try{_(s.next(u))}catch(v){g(v)}},w=u=>{try{_(s.throw(u))}catch(v){g(v)}},_=u=>u.done?y(u.value):Promise.resolve(u.value).then(x,w);_((s=s.apply(n,r)).next())});import{u as me}from"./useTable-Upa2w_0L.js";import{_ as ue}from"./Table.vue_vue_type_script_lang-DQd5IUs7.js";import{_ as ce}from"./Search.vue_vue_type_script_setup_true_lang-8pn9kdmB.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-3Xc5l_op.js";import{r as A,h as d,I as E,_ as de}from"./index-CHi5EjGf.js";/* empty css                  *//* empty css               */import{_ as fe}from"./Write.vue_vue_type_script_setup_true_lang-C7iuZ-Bx.js";import{_ as ge}from"./Dialog.vue_vue_type_style_index_0_lang-DbhVjt72.js";import{n as _e,a3 as V,k as ve,b as c}from"./element-plus-B2PLgZHf.js";import{v as be,V as G,r as m,u as o,j as ye,M as l,H as R,x as T,y as we,K as f,B as ke,a3 as $,P as L,k as H,J,G as K}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-BHRYMbwi.js";/* empty css                         *//* empty css                  */import"./index-BQh6d0I5.js";import"./Form-gS9_0x15.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-BYoZN2oo.js";import"./style.css_vue_type_style_index_0_src_true_lang-C48CRznB.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D8LijxOC.js";import"./IconPicker-BRysFjva.js";import"./IAgree.vue_vue_type_script_setup_true_lang-SWoxqzUy.js";import"./Highlight.vue_vue_type_script_lang-DCoMisvs.js";import"./useForm-D3UcvRwb.js";import"./useIcon-twKurrFj.js";/* empty css                  */function Se(n){return A.post({url:"/poker_room/select",data:{page:n.page,pageNum:n.pageSize,game_code:n.game_code}})}function O(n){return A.post({url:"/poker_room/update",data:n})}function Pe(n){return A.post({url:"/poker_room/delete",data:{ids:n}})}const Re={class:"mb-10px"},xe=be({__name:"PokerRoomSetting",setup(n){const r=G([{field:"game_name",label:"游戏名称",component:"Input"}]),s=m({}),y=a=>{s.value=a,P()},g=m({}),{tableRegister:x,tableState:w,tableMethods:_}=me({fetchDataApi:()=>p(this,null,function*(){const{currentPage:a,pageSize:e}=w,t=q({page:o(a),pageSize:o(e)},o(s));t.game_name&&(t.game_code=g.value[t.game_name]);const i=yield Se(t);return i.data.list.forEach(F=>{g.value[F.gameBase.name]=F.game_code}),{list:i.data.list||[],total:i.data.total||0}}),fetchDelApi:()=>p(this,null,function*(){return!!(yield Pe(o(B)))})}),{dataList:u,loading:v,total:Q,currentPage:k,pageSize:S}=w,{getList:P,getElTableExpose:W,delList:X}=_;ye(()=>{P()});const Y=G([{field:"selection",type:"selection"},{field:"game_code",label:"游戏编号"},{field:"game_name",label:"游戏名称",slots:{default:a=>l(R,null,[a.row.gameBase.name])}},{field:"game_code_sub",label:"房间类型id"},{field:"bet",label:"底分"},{field:"min_gold",label:"需要的最小金币"},{field:"max_gold",label:"最大金币"},{field:"name",label:"名字"},{field:"enable",label:"是否关闭",slots:{default:a=>l(R,null,[l(_e,{type:a.row.enable?"danger":"success"},{default:()=>[a.row.enable?"关闭":"开启"]})])}},{field:"desc",label:"说明"},{field:"action",label:"操作",width:180,slots:{default:a=>{const e=a.row;return l(R,null,[l(V,{content:"编辑",placement:"top"},{default:()=>[l(d,{size:"small",onClick:()=>ae(e,"edit")},{default:()=>[l(E,{icon:"vi-mingcute:edit-line"},null)]})]}),l(V,{content:Z(e.enable),placement:"top"},{default:()=>[l(d,{size:"small",onClick:()=>ee(e)},{default:()=>[l(E,{icon:"vi-ep:open"},null)]})]}),l(V,{content:"删除",placement:"top"},{default:()=>[l(d,{size:"small",onClick:()=>I(e)},{default:()=>[l(E,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),Z=a=>a===0?"关闭":"开启",ee=a=>{let e="是否关闭房间";a.enable===1&&(e="是否开启房间"),ve.confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!1}).then(()=>{const t=Object.assign({},a);t.enable=t.enable===0?1:0,te(t)}).catch(()=>{c({type:"info",message:"取消修改状态"})})},te=a=>p(this,null,function*(){var e;try{c({message:"正在更新状态...",type:"info",duration:0});const t=yield O(a);if((t==null?void 0:t.code)===200)c.closeAll(),c.success("状态更新成功"),yield P();else throw new Error(((e=t==null?void 0:t.data)==null?void 0:e.message)||"更新状态失败")}catch(t){console.error("更新状态失败:",t),c.error(t.message||"更新状态失败")}}),b=m(!1),M=m(""),D=m(),z=m(""),ae=(a,e)=>{M.value="编辑",z.value=e,D.value=a,b.value=!0},N=m(),C=m(!1),oe=()=>p(this,null,function*(){var e;const a=o(N);try{const t=yield a==null?void 0:a.submit();if(!t)return;C.value=!0,c({message:"正在保存...",type:"info",duration:0});const i=yield O(t);if((i==null?void 0:i.code)===200)c.closeAll(),c.success("操作成功"),b.value=!1,yield P();else throw new Error(((e=i==null?void 0:i.data)==null?void 0:e.message)||"操作失败")}catch(t){console.error("操作失败:",t),c.error(t.message||"操作失败")}finally{C.value=!1}}),h=m(!1),B=m([]),I=a=>p(this,null,function*(){const e=yield W();B.value=a?[a.id]:(e==null?void 0:e.getSelectionRows().map(t=>t.id))||[],h.value=!0,yield X(o(B).length).finally(()=>{h.value=!1})}),le=a=>{k.value=a},ne=a=>{S.value=a};return(a,e)=>(T(),we(R,null,[l(o(pe),null,{default:f(()=>[l(o(ce),{schema:r,onReset:y,onSearch:y},null,8,["schema"]),ke("div",Re,[l(o(d),{loading:h.value,type:"danger",onClick:e[0]||(e[0]=t=>I())},{default:f(()=>e[5]||(e[5]=[$(L("删除"))])),_:1},8,["loading"])]),l(o(ue),{pageSize:o(S),"onUpdate:pageSize":[e[1]||(e[1]=t=>H(S)?S.value=t:null),ne],currentPage:o(k),"onUpdate:currentPage":[e[2]||(e[2]=t=>H(k)?k.value=t:null),le],pagination:{total:o(Q)},columns:Y,data:o(u),loading:o(v),onRegister:o(x)},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),l(o(ge),{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=t=>b.value=t),title:M.value},{footer:f(()=>[z.value!=="detail"?(T(),J(o(d),{key:0,type:"primary",loading:C.value,onClick:oe},{default:f(()=>e[6]||(e[6]=[$(L("保存"))])),_:1},8,["loading"])):K("",!0),l(o(d),{onClick:e[3]||(e[3]=t=>b.value=!1)},{default:f(()=>e[7]||(e[7]=[$(L("关闭"))])),_:1})]),default:f(()=>[z.value==="edit"?(T(),J(fe,{key:0,ref_key:"writeRef",ref:N,"current-row":D.value},null,8,["current-row"])):K("",!0)]),_:1},8,["modelValue","title"])],64))}}),ct=de(xe,[["__scopeId","data-v-cb48de8d"]]);export{ct as default};
