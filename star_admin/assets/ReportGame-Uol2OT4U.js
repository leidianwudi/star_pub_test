var x=(D,u,c)=>new Promise((_,y)=>{var r=o=>{try{m(c.next(o))}catch(f){y(f)}},w=o=>{try{m(c.throw(o))}catch(f){y(f)}},m=o=>o.done?_(o.value):Promise.resolve(o.value).then(r,w);m((c=c.apply(D,u)).next())});import{u as E}from"./useTable-YuVhaX40.js";import{c as G,u as L}from"./index-YGSL2gxf.js";import{_ as $}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as B}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{j as R,k as I,a as j,g as F}from"./index-DOJE_sUj.js";/* empty css               *//* empty css                *//* empty css                         */import{_ as K}from"./Echart.vue_vue_type_script_setup_true_lang-t1syh85a.js";import{u as N,t as O,r as Y,s as V,v as d}from"./element-plus-B2PLgZHf.js";import{v as q,c as z,r as v,V as k,w as H,j as J,u as n,x as Q,y as U,M as l,K as g}from"./vue-chunks-COp0tDkU.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css                   *//* empty css               *//* empty css                    */import"./el-radio-button-Bvrkr5tE.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";/* empty css                      */import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./echarts-whH8FFdn.js";const W={title:{text:"每日游戏统计表",left:"center"},xAxis:{data:[],boundaryGap:!1,axisTick:{show:!1}},grid:{left:20,right:20,bottom:20,top:80,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:[],top:50},series:[]},X={class:"flex w-100% h-100%"},Le=q({__name:"ReportGame",setup(D){const{t:u}=G(),c=L(),_=z(()=>c.getIsDark),y=v(!0),r=k(W),w=e=>{const a=["spend","win","final","play_num","room_num","rtp","rtp_big"],t=["花费","奖励","结果","玩次数","房间数","普通rtp","幸运时刻rtp"];if(e&&e.code===200){const s=[];for(let p=0;p<a.length;p++){const b={name:t[p],smooth:!0,type:"line",data:e.data.list.map(C=>C[a[p]]),animationDuration:2800,animationEasing:"quadraticOut"};s.push(b)}d(r,"xAxis.data",e.data.list.map(p=>new Date(p.day).getDate())),d(r,"legend.data",t),d(r,"series",s)}},m=e=>{const a={color:_.value?"#ccc":"#333"},t=_.value?"#abacac":"#ccc";d(e,"title.textStyle",a),d(e,"legend.textStyle",a),d(e,"legend.inactiveColor",t)};H(_,()=>{m(r)}),J(()=>{m(r)});const o=v({}),{tableState:f,tableMethods:A}=E({fetchDataApi:()=>x(this,null,function*(){const{currentPage:e,pageSize:a}=f;let t={};return i.value&&i.value.game_code||i.value.day_min||i.value.type_code?t=yield R(n(e),n(a),i.value):(t=yield I(M()),t.data.list.forEach(s=>{s&&s.gameBase&&(o.value[u(s.gameBase.name)]=s.game_code)})),w(t),y.value=!1,{list:t.data.list||[],total:t.data.total||0}})}),M=()=>{const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(e.getFullYear(),e.getMonth()+1,0);return{day_min:h(a),day_max:h(t)}},{getList:P}=A,T=k([{field:"name",label:"游戏名称",component:"Select",componentProps:{nodeKey:"name",props:{label:e=>{if(e&&e.name)return u(e.name)},value:"name"},checkStrictly:!0},optionApi:()=>x(this,null,function*(){return(yield j()).data.list||[]})},{field:"type_code",label:"游戏类型",component:"Select",componentProps:{nodeKey:"type_code",props:{label:e=>{if(e&&e.type_code)return u(e.type_code)},value:"type_code"},checkStrictly:!0},optionApi:()=>x(this,null,function*(){return(yield F()).data.list||[]})},{field:"day_min",label:"起始时间",component:"DatePicker"},{field:"day_max",label:"结束时间",component:"DatePicker"}]),i=v({}),S=e=>{e&&(e.day_min||e.name)?(e.day_max||(e.day_max=e.day_min),i.value=e.day_min?{type_code:e.type_code,game_code:o.value[e.name],day_min:h(new Date(e.day_min)),day_max:h(new Date(e.day_max))}:{type_code:e.type_code,game_code:o.value[e.name]}):i.value=e,P()},h=e=>{const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${a}-${t}-${s}`};return(e,a)=>(Q(),U("div",X,[l(n(B),{class:"flex-[3] ml-20px"},{default:g(()=>[l(n($),{schema:T,onReset:S,onSearch:S},null,8,["schema"]),l(n(N),{gutter:20,justify:"space-between"},{default:g(()=>[l(n(O),{span:24},{default:g(()=>[l(n(Y),{shadow:"hover",class:"mb-20px"},{default:g(()=>[l(n(V),{loading:y.value,animated:"",rows:4},{default:g(()=>[l(n(K),{options:r,height:350},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{Le as default};
