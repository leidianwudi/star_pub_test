var se=Object.defineProperty;var K=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var q=(r,n,i)=>n in r?se(r,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[n]=i,O=(r,n)=>{for(var i in n||(n={}))re.call(n,i)&&q(r,i,n[i]);if(K)for(var i of K(n))ue.call(n,i)&&q(r,i,n[i]);return r};var d=(r,n,i)=>new Promise((P,v)=>{var R=m=>{try{y(i.next(m))}catch(b){v(b)}},h=m=>{try{y(i.throw(m))}catch(b){v(b)}},y=m=>m.done?P(m.value):Promise.resolve(m.value).then(R,h);y((i=i.apply(r,n)).next())});import{h as f,I as U}from"./index-YGSL2gxf.js";import{_ as me}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{u as ce}from"./useTable-YuVhaX40.js";/* empty css                   */import{_ as pe}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as de}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as fe}from"./Write.vue_vue_type_script_setup_true_lang-BdCZ4oU2.js";import{_ as ge}from"./Detail.vue_vue_type_script_setup_true_lang-BJ8doi4m.js";import{_ as ve}from"./Dialog.vue_vue_type_style_index_0_lang-DNc9B0lB.js";import{e as ye,f as be,h as _e,i as we}from"./index-DOJE_sUj.js";import{a3 as A,b as z}from"./element-plus-B2PLgZHf.js";import{v as Se,r as u,u as l,V as Q,M as s,H as W,j as ke,x as L,y as Ne,K as g,B as Ce,a3 as E,k as X,J as B,P as Y,G as I}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./Descriptions-CGScbuMD.js";/* empty css                  */const ze={class:"mb-10px"},vt=Se({__name:"GameLogUtc",setup(r){const n=u([]),i=u({}),{tableRegister:P,tableState:v,tableMethods:R}=ce({fetchDataApi:()=>d(this,null,function*(){const{currentPage:t,pageSize:e}=v,a=O({page:l(t),pageSize:l(e)},l(i)),o=yield ye(a);return{list:o.data.list||[],total:o.data.total||0}}),fetchDelApi:()=>d(this,null,function*(){return!!(yield be(l(n)))})}),h=Q([{field:"sn",label:"订单号",component:"Input"},{field:"account",label:"用户账户",component:"Input"},{field:"game_type",label:"游戏类型",component:"Input"},{field:"game_code",label:"游戏编号",component:"Input"}]),{dataList:y,loading:m,total:b,currentPage:w,pageSize:S}=v,{getList:D,getElTableExpose:Z,delList:ee}=R,te=Q([{field:"selection",type:"selection"},{field:"utc",label:"时区"},{field:"sn",label:"订单号"},{field:"account",label:"用户账户"},{field:"game_type",label:"游戏类型"},{field:"game_code",label:"游戏编号"},{field:"spend",label:"花费"},{field:"win",label:"赢得"},{field:"final",label:"最终赢得"},{field:"create_at",label:"时间"},{field:"desc",label:"备注"},{field:"action",label:"操作",width:180,slots:{default:t=>{const e=t.row;return s(W,null,[s(A,{content:"编辑",placement:"top"},{default:()=>[s(f,{size:"small",onClick:()=>M(e,"edit")},{default:()=>[s(U,{icon:"vi-mingcute:edit-line"},null)]})]}),s(A,{content:"详情",placement:"top"},{default:()=>[s(f,{size:"small",onClick:()=>M(e,"detail")},{default:()=>[s(U,{icon:"vi-bx:detail"},null)]})]}),s(A,{content:"删除",placement:"top"},{default:()=>[s(f,{size:"small",onClick:()=>x(e)},{default:()=>[s(U,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),_=u(!1),F=u(""),T=u(),k=u(""),M=(t,e)=>{F.value=e==="edit"?"编辑":"详情",k.value=e,T.value=t,_.value=!0},G=u(),V=u(!1),ae=()=>d(this,null,function*(){var e;const t=l(G);try{const a=yield t==null?void 0:t.submit();if(!a)return;V.value=!0,a.desc||(a.desc=""),z({message:"正在保存...",type:"info",duration:0});const o=yield we(a);if((o==null?void 0:o.code)===200)z.closeAll(),z.success("操作成功"),_.value=!1,yield D();else throw new Error(((e=o==null?void 0:o.data)==null?void 0:e.message)||"操作失败")}catch(a){console.error("操作失败:",a),z.error(a.message||"操作失败")}finally{V.value=!1}}),$=u(!1),x=t=>d(this,null,function*(){const e=yield Z();n.value=t?[t.id]:(e==null?void 0:e.getSelectionRows().map(a=>a.id))||[],$.value=!0,yield ee(l(n).length).finally(()=>{$.value=!1})}),j=t=>{i.value=t,D()},oe=t=>{w.value=t},le=t=>{S.value=t},ie=t=>{const{columns:e,data:a}=t,o=[];return e.forEach((C,c)=>{if(c===0){o[c]="总计";return}if(["spend","win","final"].includes(C.property))if(N.value&&N.value.list[0][C.property]!==void 0)o[c]=Number(N.value.list[0][C.property]).toFixed(2);else{const H=t.data.map(p=>Number(p[C.property]));H.every(p=>isNaN(p))?o[c]="N/A":(o[c]=H.reduce((p,ne)=>{const J=Number(ne);return isNaN(J)?p:p+J},0),o[c]=o[c].toFixed(2))}else o[c]=""}),o},N=u(null);return ke(()=>d(this,null,function*(){try{const t=yield _e();N.value=t.data}catch(t){console.error("获取游戏报表总计数据失败:",t)}})),(t,e)=>(L(),Ne(W,null,[s(l(de),null,{default:g(()=>[s(l(pe),{schema:h,onReset:j,onSearch:j},null,8,["schema"]),Ce("div",ze,[s(l(f),{loading:$.value,type:"danger",onClick:e[0]||(e[0]=a=>x())},{default:g(()=>e[5]||(e[5]=[E("删除")])),_:1},8,["loading"])]),s(l(me),{pageSize:l(S),"onUpdate:pageSize":[e[1]||(e[1]=a=>X(S)?S.value=a:null),le],currentPage:l(w),"onUpdate:currentPage":[e[2]||(e[2]=a=>X(w)?w.value=a:null),oe],pagination:{total:l(b)},columns:te,data:l(y),loading:l(m),onRegister:l(P),"show-summary":"","summary-method":ie},null,8,["pageSize","currentPage","pagination","columns","data","loading","onRegister"])]),_:1}),s(l(ve),{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value=a),title:F.value},{footer:g(()=>[k.value!=="detail"?(L(),B(l(f),{key:0,type:"primary",loading:V.value,onClick:ae},{default:g(()=>e[6]||(e[6]=[E(Y("保存"))])),_:1},8,["loading"])):I("",!0),s(l(f),{onClick:e[3]||(e[3]=a=>_.value=!1)},{default:g(()=>e[7]||(e[7]=[E(Y("关闭"))])),_:1})]),default:g(()=>[k.value==="edit"?(L(),B(fe,{key:0,ref_key:"writeRef",ref:G,"current-row":T.value},null,8,["current-row"])):I("",!0),k.value==="detail"?(L(),B(ge,{key:1,"current-row":T.value},null,8,["current-row"])):I("",!0)]),_:1},8,["modelValue","title"])],64))}});export{vt as default};
