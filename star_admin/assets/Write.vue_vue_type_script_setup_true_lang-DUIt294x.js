var f=(p,m,t)=>new Promise((c,r)=>{var u=o=>{try{a(t.next(o))}catch(s){r(s)}},d=o=>{try{a(t.throw(o))}catch(s){r(s)}},a=o=>o.done?c(o.value):Promise.resolve(o.value).then(u,d);a((t=t.apply(p,m)).next())});import{F as k}from"./Form-BurHqMWS.js";import{u as y}from"./useForm-dGPra2nm.js";import{u as E}from"./useValidator-DY0gbKVw.js";import{g as F}from"./index-BTBuQ87_.js";import{v as I,r as D,c as w,V as h,w as O,x as P,J as V,u as b,n as A}from"./vue-chunks-COp0tDkU.js";const L=I({__name:"Write",props:{currentRow:{type:Object,default:()=>{}}},setup(p,{expose:m}){const{required:t}=E(),c=p,r=D([]),u=w(()=>{var e;return!!((e=c.currentRow)!=null&&e.id)}),d=h([{field:"account",label:"账号",component:"Input"},{field:"password",label:"密码",component:"InputPassword",componentProps:w(()=>({disabled:u.value}))},{field:"nick",label:"昵称",component:"Input"},{field:"role_name",label:"角色",component:"Select",componentProps:{options:r}},{field:"desc",label:"说明",component:"Input"}]),a=h({account:[t()],password:[t()]}),o=()=>f(this,null,function*(){var e,i;try{const n=yield F();r.value=(i=(e=n.data)==null?void 0:e.list)==null?void 0:i.map(l=>({label:l.role_name||l.role||`角色 ${l.id}`,value:l.id})),yield A()}catch(n){console.error("Error fetching role options:",n)}}),{formRegister:s,formMethods:_}=y(),{setValues:g,getFormData:R,getElFormExpose:x}=_,v=()=>f(this,null,function*(){const e=yield x();if(yield e==null?void 0:e.validate().catch(n=>{}))return yield R()});return O(()=>c.currentRow,e=>{o(),e&&g(e)},{deep:!0,immediate:!0}),m({submit:v}),(e,i)=>(P(),V(b(k),{rules:a,onRegister:b(s),schema:d},null,8,["rules","onRegister","schema"]))}});export{L as _};
