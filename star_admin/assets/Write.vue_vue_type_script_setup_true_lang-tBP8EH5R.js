var h=(p,u,t)=>new Promise((a,i)=>{var m=n=>{try{l(t.next(n))}catch(s){i(s)}},d=n=>{try{l(t.throw(n))}catch(s){i(s)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(m,d);l((t=t.apply(p,u)).next())});import{F as _}from"./Form-BurHqMWS.js";import{u as A}from"./useForm-dGPra2nm.js";import{u as S}from"./useValidator-DY0gbKVw.js";import{c as x}from"./index-YGSL2gxf.js";import{b as P}from"./index-BcVtqPiW.js";import{c as k}from"./element-plus-B2PLgZHf.js";import{v as E,V as b,r as F,w as M,x as V,J as B,u as v}from"./vue-chunks-COp0tDkU.js";const T=E({__name:"Write",props:{currentRow:{type:Object,default:()=>null}},setup(p,{expose:u}){const{t}=x(),{required:a}=S(),i=p,m=b([{field:"pid",label:t("menu.parentMenu"),component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:e=>e&&e.title?t(e.title):"根目录",value:"id",children:"children"},checkStrictly:!0},optionApi:()=>h(this,null,function*(){const e=yield P();return e.code===200&&(e.data.list=d(e.data)),e.data.list||[]})},{field:"title",label:t("menu.menuName"),component:"Input"},{field:"sort",label:t("menu.sort"),component:"InputNumber"},{field:"component",label:t("menu.component"),component:"Input"},{field:"name",label:"名称",component:"Input"},{field:"icon",label:t("menu.icon"),component:"IconPicker"},{field:"path",label:t("menu.path"),component:"Input"},{field:"status",label:t("menu.status"),component:"Select",componentProps:{options:[{label:t("userDemo.disable"),value:0},{label:t("userDemo.enable"),value:1}]}},{field:"display",label:t("menu.hidden"),component:"Select",componentProps:{options:[{label:"隐藏",value:0},{label:"显示",value:1}]}}]),d=e=>{if(!e.list||!Array.isArray(e.list))return[];const r=e.list,c=[{id:"0",title:"顶级目录",display:1}],f={};return r.forEach(o=>{o.children=o.children||[],f[o.id]=o}),r.forEach(o=>{o.pid&&f[o.pid]?f[o.pid].children.push(o):c.push(o)}),c},l=b({component:[a()],path:[a()],title:[a()],name:[a()],pid:[a()],sort:[a()]}),{formRegister:n,formMethods:s}=A(),{setValues:y,getFormData:w,getElFormExpose:g,setSchema:D}=s,I=()=>h(this,null,function*(){const e=yield g();if(yield e==null?void 0:e.validate().catch(c=>{}))return yield w()}),R=F("");return M(()=>i.currentRow,e=>{if(!e)return;const r=k(e);R.value=r.type===1?r.component:"",D([{field:"component",path:"componentProps.disabled",value:!1}]),y(r)},{deep:!0,immediate:!0}),u({submit:I}),(e,r)=>(V(),B(v(_),{rules:l,onRegister:v(n),schema:m},null,8,["rules","onRegister","schema"]))}});export{T as _};
