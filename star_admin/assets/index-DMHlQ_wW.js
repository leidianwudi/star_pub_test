var y=($,n,r)=>new Promise((g,v)=>{var P=s=>{try{c(r.next(s))}catch(_){v(_)}},b=s=>{try{c(r.throw(s))}catch(_){v(_)}},c=s=>s.done?g(s.value):Promise.resolve(s.value).then(P,b);c((r=r.apply($,n)).next())});import{u as Y}from"./useTable-YuVhaX40.js";import{c as Z,h as f,I as E}from"./index-YGSL2gxf.js";import{_ as ee}from"./Table.vue_vue_type_script_lang-DscfV0RP.js";import{_ as te}from"./Search.vue_vue_type_script_setup_true_lang-Yr7An4L0.js";import{_ as ae}from"./ContentWrap.vue_vue_type_script_setup_true_lang-QawWAx3l.js";import{_ as le}from"./Write.vue_vue_type_script_setup_true_lang-STzDEkwx.js";import{_ as oe}from"./Detail.vue_vue_type_script_setup_true_lang-C55L37jr.js";/* empty css                  *//* empty css                   */import{e as ne,f as ie,h as se,i as re}from"./index-DjK7QjaX.js";import{a3 as B,a4 as ue,b as me}from"./element-plus-B2PLgZHf.js";import{v as ce,r as i,u as a,V as M,M as l,H as u,x,y as pe,K as m,B as de,a3 as h,P as C,k as F,J as T,G as V}from"./vue-chunks-COp0tDkU.js";/* empty css                    *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                */import"./el-radio-button-Bvrkr5tE.js";/* empty css                         *//* empty css                  */import"./index-A9CPyHPp.js";import"./Form-BurHqMWS.js";/* empty css                     *//* empty css               *//* empty css                        *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-C3UAhF1U.js";import"./style.css_vue_type_style_index_0_src_true_lang-Bl0IfL3J.js";import"./wang-editor-FTv6NaqD.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-D7iXgQwo.js";import"./IconPicker-Bnk7u0qr.js";import"./IAgree.vue_vue_type_script_setup_true_lang-AinzJ7sY.js";import"./Highlight.vue_vue_type_script_lang-DIkvOg1B.js";import"./useForm-dGPra2nm.js";import"./useIcon-BkUmXMGL.js";import"./useValidator-DY0gbKVw.js";import"./AddButtonPermission.vue_vue_type_script_setup_true_lang-D5iWQWVt.js";import"./Descriptions-CGScbuMD.js";const fe={class:"mb-10px"},ot=ce({__name:"index",setup($){const{t:n}=Z(),r=i(!1),g=i([]),v=i({}),{tableRegister:P,tableState:b,tableMethods:c}=Y({fetchDataApi:()=>y(this,null,function*(){const{currentPage:t,pageSize:e}=b;let o={};return w.value&&w.value.id?o=yield ne(w.value.id):(o=yield ie(a(t),a(e)),o.data.list.forEach(A=>{A.name&&(v.value[n(A.name)]=A.id)})),{list:o.data.list||[],total:o.data.total||0}}),fetchDelApi:()=>y(this,null,function*(){return!!(yield se(a(g)))})}),{dataList:s,total:_,loading:U,currentPage:D,pageSize:k}=b,{getList:G,getElTableExpose:H,delList:J}=c,K=M([{field:"selection",type:"selection"},{field:"component",label:n("userDemo.gameId"),slots:{default:t=>{const e=t.row.game_id;return l(u,null,[e])}}},{field:"component",label:"key",slots:{default:t=>{const e=t.row.key;return l(u,null,[e])}}},{field:"component",label:n("userDemo.gameName"),slots:{default:t=>{const e=t.row.name;return l(u,null,[e])}}},{field:"component",label:n("userDemo.value1"),component:"Input",slots:{default:t=>{const e=t.row.value1;return l(u,null,[e])}}},{field:"path",label:n("userDemo.desc"),slots:{default:t=>{const e=t.row.desc;return l(u,null,[e])}}},{field:"action",label:n("userDemo.action"),width:120,slots:{default:t=>{const e=t.row;return l(u,null,[l(B,{content:"编辑",placement:"top"},{default:()=>[l(f,{size:"small",onClick:()=>j(e,"edit")},{default:()=>[l(E,{icon:"vi-mingcute:edit-line"},null)]})]}),l(B,{content:"删除",placement:"top"},{default:()=>[l(f,{size:"small",onClick:()=>N(e)},{default:()=>[l(E,{icon:"vi-mingcute:delete-2-line"},null)]})]})])}}}]),O=M([{field:"component",label:n("userDemo.gameName"),component:"Input"}]),w=i({}),I=t=>{t&&t.component?w.value={id:v.value[t.component]}:w.value=t,G()},p=i(!1),R=i(""),S=i(),d=i(""),L=i(),z=i(!1),j=(t,e)=>{R.value=n("exampleDemo.edit"),d.value=e,S.value=t,p.value=!0},N=t=>y(this,null,function*(){const e=yield H();g.value=t?[t.id]:(e==null?void 0:e.getSelectionRows().map(o=>o.id))||[],r.value=!0,yield J(a(g).length).finally(()=>{r.value=!1})}),q=()=>{R.value=n("exampleDemo.add"),S.value=void 0,p.value=!0,d.value=""},Q=()=>y(this,null,function*(){const t=a(L),e=yield t==null?void 0:t.submit();e&&e.update_at&&(e.update_at=new Date),e&&(z.value=!0,(yield re(e)).code===200&&(z.value=!1,p.value=!1,c.getList(),me({type:"success",message:d.value==="edit"?"修改成功":"添加成功"})))}),W=t=>{D.value=t},X=t=>{k.value=t};return(t,e)=>(x(),pe(u,null,[l(a(ae),null,{default:m(()=>[l(a(te),{schema:O,onReset:I,onSearch:I},null,8,["schema"]),de("div",fe,[l(a(f),{type:"primary",onClick:q},{default:m(()=>[h(C(a(n)("exampleDemo.add")),1)]),_:1}),l(a(f),{loading:r.value,type:"danger",onClick:e[0]||(e[0]=o=>N())},{default:m(()=>[h(C(a(n)("exampleDemo.del")),1)]),_:1},8,["loading"])]),l(a(ee),{pageSize:a(k),"onUpdate:pageSize":[e[1]||(e[1]=o=>F(k)?k.value=o:null),X],currentPage:a(D),"onUpdate:currentPage":[e[2]||(e[2]=o=>F(D)?D.value=o:null),W],columns:K,"default-expand-all":"",headerAlign:"center",align:"center","node-key":"id",data:a(s),loading:a(U),pagination:{total:a(_)},onRegister:a(P)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),l(a(ue),{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=o=>p.value=o),title:R.value,resizable:""},{footer:m(()=>[d.value!=="detail"?(x(),T(a(f),{key:0,type:"primary",loading:z.value,onClick:Q},{default:m(()=>[h(C(a(n)("exampleDemo.save")),1)]),_:1},8,["loading"])):V("",!0),l(a(f),{onClick:e[3]||(e[3]=o=>p.value=!1)},{default:m(()=>[h(C(a(n)("dialogDemo.close")),1)]),_:1})]),default:m(()=>[d.value!=="detail"?(x(),T(le,{key:0,ref_key:"writeRef",ref:L,"current-row":S.value},null,8,["current-row"])):V("",!0),d.value==="detail"?(x(),T(oe,{key:1,"current-row":S.value},null,8,["current-row"])):V("",!0)]),_:1},8,["modelValue","title"])],64))}});export{ot as default};
