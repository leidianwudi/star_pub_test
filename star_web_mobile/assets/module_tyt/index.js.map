{"version":3,"sources":["../file:/D:/work/github/star_client/assets/module_tyt/scripts/file:/D:/work/github/star_client/assets/module_tyt/scripts/MyUtil.ts","../file:/D:/work/github/star_client/assets/module_tyt/scripts/file:/D:/work/github/star_client/assets/module_tyt/scripts/TYTAudioManager.ts","../file:/D:/work/github/star_client/assets/module_tyt/scripts/file:/D:/work/github/star_client/assets/module_tyt/scripts/TYTGameManager.ts","../file:/D:/work/github/star_client/assets/module_tyt/scripts/file:/D:/work/github/star_client/assets/module_tyt/scripts/TYTGameMgr.ts","../file:/D:/work/github/star_client/assets/module_tyt/scripts/file:/D:/work/github/star_client/assets/module_tyt/scripts/TYTLobbyScene.ts"],"names":["MyUtil","angle2D","a","b","Vec2","angle","y","math","TWO_PI","Vec3","RIGHT","z","degreesToVector","deg","radians","Math","PI","x","cos","sin","timeFormat","value","num","v","parseFloat","toFixed","minute","floor","seconds","nowDayZeroTimeStamp","d","Date","setHours","setMinutes","setSeconds","getTime","checkValue","undefined","loadBundle","name","Promise","resolve","reject","assetManager","err","bundle","numKString","toString","shuffleArray","array","shuffledArray","slice","currentIndex","length","temporaryValue","randomIndex","random","reserve","numStr","Number","_RF","pop","ccclass","_decorator","property","TYTAudioManager","_dec","_class","_Component","_inheritsLoose","_this","_len","arguments","args","Array","_key","call","apply","concat","musicVolume","soundVolume","musicAudioSource","AudioSource","soundAudioSource","bgmClip","dieClip","scoreClip","exactScoreClip","storageClip","birthClip","gameManager","settingPopupNode","_proto","prototype","onLoad","find","getComponent","TYTGameManager","start","updateProgress","onDestroy","loadAssert","_this2","loadMap","loadList","Object","keys","forEach","key","path","push","ResourceMgr","inst","loadResByModuleBundle","ModuleDef","TYT","AudioClip","audioClip","console","log","all","then","res","onSliderChange","slider","progress","volume","getChildByPath","Slider","ProgressBar","playBGM","playing","clip","loop","play","stopBGM","stop","stopPlaySound","playDie","playOneShot","playScore","playExactScore","playStorage","playBirth","onSettingOpen","active","onSettingClose","onBtnExitClicked","_onBtnExitClicked","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","_this3","wrap","_callee2$","_context2","prev","next","tgx","UIAlert","show","LanguageData","getLangByID","onClick","_callee","ok","_callee$","_context","UIMgr","closeAll","setUiLandscape","RoomMgr","exitRoom","update","deltaTime","Component","GameStatus","gameConfig","gameStatus","init","_score","nowFootholdNode","nextFootholdNode","pressFlag","pressTime","jumpFlag","audioManager","gameCameraNode","bgNode","roleContainerNode","roleNode","roleImgNode","roleImgInitPos","roleEffectStorageNode","roleEffectsNode","roleEffectsInitPos","scoreTextsNode","readyUINode","runUINode","gameOverPopupNode","footholdsNode","scoreNode","rolePrefab","scoreTextPrefab","prefabUrlMap","pressTween","gameCanvas","uiCanvas","input","on","Input","EventType","TOUCH_START","touchStart","TOUCH_END","touchEnd","loadGameConfig","initData","off","JsonAsset","jsonAsset","json","_this4","Prefab","prefab","prefabUrls","prefabUrl","setGameStauts","stauts","ready","running","end","children","node","destroy","score","generateFoothold","instantiate","addChild","getPosition","setWorldPosition","tween","to","worldPosition","first","footholdKey","randomRangeInt","footholdNode","imgNode","imgInitPos","UIOpacity","opacity","setPosition","add3f","insertChild","distance","randomRange","direction","getWorldPosition","parallel","position","event","_this5","ParticleSystem2D","enabled","roleTween","scale","footholdHeight","UITransform","contentSize","height","foothodldTween","onUpdate","ratio","clone","subtract3f","getScale","_this6","touchMaxTime","rolePos","subtract","normalize","targetPos","leftRotateFlag","jumpAniRunTime","moveTween","upTween","multiplyScalar","rotateTween","jumpEnd","viewUpdate","_this7","add","easing","target","onComplete","_this8","footholdConfig","nowDistance","nowFootHoldRadius","nextDistance","nextFootHoldRadius","generateScoreText","runtime","exactScoreNode","exactScoreOpacity","setScale","nextFlag","gameOver","textNode","Label","string","startPos","onBeginBtnClick","onAgainBtnClick","_createClass","get","set","TYTGameMgr","_class2","_GameMgr","_gameType","SubGameDef","_entryScene","_gameScene","initNetMsgHandlers","initSoloMode","reset","SubGameMgr","gameMgr","_inst","GameMgr","registerGameMgr","TYTLobbyScene","_dec2","Node","_initializerDefineProperty","_descriptor","_assertThisInitialized","_start","UserMgr","uid","SceneUtil","loadScene","SceneDef","START","abrupt","showUI","UIAnnouncement","ui","announcementPlacer","onBtnSoloModeClicked","UIWaiting","gameScene","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"mappings":"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","file":"all.js","sourcesContent":["import { assetManager, math, Vec2, Vec3 } from \"cc\";\r\n\r\nexport class MyUtil {\r\n\r\n  public static angle2D(a: Vec2, b: Vec2= new Vec2(1, 0)){\r\n    let angle = Vec2.angle(a, b)\r\n    if (a.y < b.y){\r\n      angle = math.TWO_PI - angle\r\n    }\r\n    return angle\r\n  }\r\n\r\n  public static angle(a: Vec3, b: Vec3=Vec3.RIGHT): number{\r\n    let angle = Vec3.angle(a, b)\r\n    if (a.z < b.z){\r\n      angle = math.TWO_PI - angle\r\n    }\r\n    return angle\r\n  }\r\n\r\n  public static degreesToVector(deg: number) {\r\n    const radians = deg * (Math.PI / 180)\r\n    return {\r\n        x: Math.cos(radians),\r\n        y: Math.sin(radians)\r\n    }\r\n  }\r\n\r\n  public static timeFormat(value: number, num: number=3): string{\r\n    const v = parseFloat(value.toFixed(num))\r\n    const minute = Math.floor(v / 60)\r\n    const seconds = v % 60\r\n    if (minute){\r\n      return `${minute > 9 ? minute : `0${minute}`}:${seconds < 10 ? `0${seconds.toFixed(num)}` : seconds.toFixed(num)}`\r\n    }\r\n    return `${seconds < 10 ? `0${seconds.toFixed(num)}` : seconds.toFixed(num)}`\r\n  }\r\n\r\n  public static nowDayZeroTimeStamp(d: Date = new Date()): number{\r\n    d.setHours(0)\r\n    d.setMinutes(0)\r\n    d.setSeconds(0)\r\n    return d.getTime()\r\n  }\r\n\r\n  // JSON.parse之前检查是否有数据\r\n  public static checkValue(v: any) : boolean{\r\n    if (v === '' || v === undefined || v === null) return false\r\n    return true\r\n  }\r\n\r\n  public static loadBundle(name: string){\r\n    return new Promise((resolve, reject)=>{\r\n        assetManager.loadBundle(name, (err, bundle) => {\r\n            if (err) {\r\n                return reject(err);\r\n            }\r\n            resolve(bundle);\r\n        })\r\n    })\r\n  }\r\n\r\n  public static numKString(num: number){\r\n    return num < 1000 ? Math.floor(num).toString() : `${Math.floor(num / 100) / 10}K`\r\n  }\r\n\r\n  public static shuffleArray(array) {\r\n    const shuffledArray = array.slice()\r\n    let currentIndex = shuffledArray.length\r\n    let temporaryValue, randomIndex\r\n   \r\n    // 如果还有元素需要排序\r\n    while (0 !== currentIndex) {\r\n      // 随机选择一个未排序的元素\r\n      randomIndex = Math.floor(Math.random() * currentIndex)\r\n      currentIndex -= 1\r\n   \r\n      // 与当前元素交换\r\n      temporaryValue = shuffledArray[currentIndex]\r\n      shuffledArray[currentIndex] = shuffledArray[randomIndex]\r\n      shuffledArray[randomIndex] = temporaryValue\r\n    }\r\n   \r\n    return shuffledArray\r\n  }\r\n\r\n  public static toFixed(num: number, reserve = 2) {\r\n    const numStr = num.toFixed(reserve+1)\r\n    // 去掉最后一位数字\r\n    return Number(numStr.slice(0, numStr.length - 1))\r\n  }\r\n\r\n}","import { _decorator, Component, Node, AudioClip, AudioSource, find, Slider, ProgressBar, assetManager, tween } from 'cc';\r\nimport { TYTGameManager } from './TYTGameManager';\r\nimport { RoomMgr } from '../../module_basic/scripts/RoomMgr';\r\nimport { SceneDef } from '../../scripts/SceneDef';\r\nimport { ResourceMgr } from '../../core_tgx/base/ResourceMgr';\r\nimport { ModuleDef } from '../../scripts/ModuleDef';\r\nimport { LanguageData } from 'db://assets/module_basic/scripts/language/LanguageData';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('TYTAudioManager')\r\nexport class TYTAudioManager extends Component {\r\n\r\n    musicVolume = 1\r\n    soundVolume = 1\r\n    musicAudioSource: AudioSource = new AudioSource()\r\n    soundAudioSource: AudioSource = new AudioSource()\r\n    bgmClip: AudioClip = null\r\n    dieClip: AudioClip = null\r\n    scoreClip: AudioClip = null\r\n    exactScoreClip: AudioClip = null\r\n    storageClip: AudioClip = null\r\n    birthClip: AudioClip = null\r\n\r\n    gameManager: TYTGameManager = null\r\n\r\n    settingPopupNode: Node = null\r\n\r\n\r\n    onLoad() {\r\n        this.gameManager = find('TYTGameManager').getComponent(TYTGameManager)\r\n        this.settingPopupNode = find('UICanvas/PortraitNode/Mask/ReadyUI/SettingPopup')\r\n    }\r\n\r\n    start() {\r\n        this.updateProgress('sound')\r\n        this.updateProgress('music')\r\n    }\r\n\r\n    onDestroy() {\r\n\r\n    }\r\n\r\n    loadAssert() {\r\n        return new Promise((resolve, reject) => {\r\n            // 批量加载prefab\r\n            const loadMap = {\r\n                bgmClip: 'res/music/bgm',\r\n                dieClip: 'res/music/die',\r\n                scoreClip: 'res/music/score',\r\n                exactScoreClip: 'res/music/exact_score',\r\n                storageClip: 'res/music/storage',\r\n                birthClip: 'res/music/birth',\r\n            }\r\n            const loadList = []\r\n            Object.keys(loadMap).forEach(key => {\r\n                const path = loadMap[key]\r\n                loadList.push(\r\n                    new Promise((resolve, reject) => {\r\n                        ResourceMgr.inst.loadResByModuleBundle(ModuleDef.TYT, path, AudioClip, (err, audioClip) => {\r\n                            if (err) {\r\n                                console.log(\"load err:\", err)\r\n                                reject(err)\r\n                                return\r\n                            }\r\n                            this[key] = audioClip\r\n                            resolve(0)\r\n                        })\r\n                    })\r\n                )\r\n            })\r\n            Promise.all([\r\n                ...loadList,\r\n            ]).then(res => {\r\n                resolve(0)\r\n            })\r\n        })\r\n    }\r\n\r\n    onSliderChange(slider: Slider, key: string) {\r\n        if (key === 'sound') {\r\n            this.soundVolume = slider.progress\r\n        }\r\n        else if (key === 'music') {\r\n            this.musicVolume = slider.progress\r\n            this.musicAudioSource.volume = this.musicVolume\r\n        }\r\n        this.updateProgress(key)\r\n    }\r\n\r\n    updateProgress(key: string) {\r\n        if (key === 'sound') {\r\n            this.settingPopupNode.getChildByPath('Content/Sound/Slider').getComponent(Slider).progress = this.soundVolume\r\n            this.settingPopupNode.getChildByPath('Content/Sound/Slider/ProgressBar').getComponent(ProgressBar).progress = this.soundVolume\r\n        }\r\n        else if (key === 'music') {\r\n            this.settingPopupNode.getChildByPath('Content/Music/Slider').getComponent(Slider).progress = this.musicVolume\r\n            this.settingPopupNode.getChildByPath('Content/Music/Slider/ProgressBar').getComponent(ProgressBar).progress = this.musicVolume\r\n        }\r\n    }\r\n\r\n    playBGM() {\r\n        if (this.musicAudioSource.playing) {\r\n            return\r\n        }\r\n        this.musicAudioSource.clip = this.bgmClip\r\n        this.musicAudioSource.loop = true\r\n        this.musicAudioSource.volume = this.musicVolume\r\n        this.musicAudioSource.play()\r\n    }\r\n\r\n    stopBGM() {\r\n        this.musicAudioSource.stop();\r\n    }\r\n\r\n    stopPlaySound() {\r\n        this.soundAudioSource.stop();\r\n    }\r\n\r\n    playDie() {\r\n        this.soundAudioSource.playOneShot(this.dieClip, this.soundVolume)\r\n    }\r\n\r\n    playScore() {\r\n        this.soundAudioSource.playOneShot(this.scoreClip, this.soundVolume)\r\n    }\r\n\r\n    playExactScore() {\r\n        this.soundAudioSource.playOneShot(this.exactScoreClip, this.soundVolume)\r\n    }\r\n\r\n    playStorage() {\r\n        this.soundAudioSource.clip = this.storageClip\r\n        this.soundAudioSource.volume = this.soundVolume\r\n        this.soundAudioSource.play()\r\n        // this.soundAudioSource.playOneShot(this.storageClip, this.soundVolume)\r\n    }\r\n\r\n    playBirth() {\r\n        this.soundAudioSource.playOneShot(this.birthClip, this.soundVolume)\r\n    }\r\n\r\n    onSettingOpen() {\r\n        this.settingPopupNode.active = false\r\n    }\r\n\r\n    onSettingClose() {\r\n        this.settingPopupNode.active = false\r\n    }\r\n\r\n    async onBtnExitClicked() {\r\n        //if (RoomMgr.inst.isPlayer && RoomMgr.inst.isPlaying) {\r\n        tgx.UIAlert.show(LanguageData.getLangByID(\"exit_game\"), true).onClick(async (ok: Boolean) => {\r\n            if (ok) {\r\n                this.stopBGM();\r\n                this.stopPlaySound();\r\n                tgx.UIMgr.inst.closeAll();\r\n                tgx.UIMgr.inst.setUiLandscape();//换回横屏\r\n                // tgx.SceneUtil.loadScene(SceneDef.LOBBY);\r\n                RoomMgr.inst.exitRoom();\r\n                //await RoomMgr.inst.backToLobby();\r\n                //tgx.SceneUtil.loadScene(Slots4GameMgr.inst.entryScene);\r\n            }\r\n        });\r\n        //}\r\n    }\r\n\r\n\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node, Vec3, Prefab, assetManager, view, input, Input, EventTouch, find, JsonAsset, randomRangeInt, randomRange, instantiate, tween, Label, Animation, Tween, UIOpacity, UITransform, ParticleSystem2D } from 'cc';\r\nimport { MyUtil } from './MyUtil';\r\nimport { TYTAudioManager } from './TYTAudioManager';\r\nimport { ModuleDef } from '../../scripts/ModuleDef';\r\nimport { ResourceMgr } from '../../core_tgx/base/ResourceMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport enum GameStatus {\r\n    init = 0,\r\n    ready = 1,\r\n    running = 2,\r\n    end = 3,\r\n}\r\n\r\n@ccclass('TYTGameManager')\r\nexport class TYTGameManager extends Component {\r\n    gameConfig = {}\r\n    gameStatus = GameStatus.init\r\n    _score = 0\r\n    nowFootholdNode: Node = null\r\n    nextFootholdNode: Node = null\r\n    pressFlag = false\r\n    pressTime = 0\r\n    jumpFlag = false\r\n\r\n    audioManager: TYTAudioManager = null\r\n    gameCameraNode: Node = null\r\n    bgNode: Node = null\r\n    roleContainerNode: Node = null\r\n    roleNode: Node = null\r\n    roleImgNode: Node = null\r\n    roleImgInitPos = new Vec3()\r\n    roleEffectStorageNode: Node = null\r\n    roleEffectsNode: Node = null\r\n    roleEffectsInitPos = new Vec3()\r\n    scoreTextsNode: Node = null\r\n\r\n    readyUINode: Node = null\r\n    runUINode: Node = null\r\n    gameOverPopupNode: Node = null\r\n    footholdsNode: Node = null\r\n    scoreNode: Node = null\r\n\r\n    rolePrefab: Prefab = null\r\n    scoreTextPrefab: Prefab = null\r\n\r\n    prefabUrlMap = {}\r\n\r\n    get score() {\r\n        return this._score\r\n    }\r\n\r\n    set score(v: number) {\r\n        this._score = v\r\n        this.scoreNode.getComponent(Label).string = `得分：${this.score}`\r\n    }\r\n\r\n    onLoad() {\r\n        const gameCanvas = find('Canvas')\r\n        this.audioManager = find('TYTAudioManager').getComponent(TYTAudioManager)\r\n        this.gameCameraNode = gameCanvas.getChildByPath('GameCamera')\r\n        this.bgNode = gameCanvas.getChildByPath('PortraitNode/BG')\r\n        this.roleContainerNode = gameCanvas.getChildByPath('PortraitNode/Mask/RoleContainer')\r\n        this.footholdsNode = gameCanvas.getChildByPath('PortraitNode/Mask/Footholds')\r\n        this.scoreTextsNode = gameCanvas.getChildByPath('PortraitNode/Mask/ScoreTexts')\r\n\r\n        const uiCanvas = find('UICanvas')\r\n        this.readyUINode = uiCanvas.getChildByPath('PortraitNode/Mask/ReadyUI')\r\n        this.readyUINode.active = false\r\n        this.runUINode = uiCanvas.getChildByPath('PortraitNode/Mask/RunUI')\r\n        this.runUINode.active = false\r\n        this.gameOverPopupNode = uiCanvas.getChildByPath('PortraitNode/Mask/GameOverPopup')\r\n        this.gameOverPopupNode.active = false\r\n        this.scoreNode = uiCanvas.getChildByPath('PortraitNode/Mask/RunUI/Score')\r\n        input.on(Input.EventType.TOUCH_START, this.touchStart, this)\r\n        input.on(Input.EventType.TOUCH_END, this.touchEnd, this)\r\n\r\n        tgx.UIMgr.inst.closeAll();//关闭所有UI\r\n        // tgx.UIMgr.inst.setUiPortrait();//切换ui竖屏\r\n    }\r\n\r\n    start() {\r\n        this.loadGameConfig().then(() => {\r\n            this.loadAssert().then(() => {\r\n                this.audioManager.playBGM()\r\n                this.initData()\r\n            })\r\n        })\r\n    }\r\n\r\n    onDestroy() {\r\n        input.off(Input.EventType.TOUCH_START, this.touchStart, this)\r\n        input.off(Input.EventType.TOUCH_END, this.touchEnd, this)\r\n    }\r\n\r\n    loadGameConfig() {\r\n        return new Promise((resolve, reject) => {\r\n            ResourceMgr.inst.loadResByModuleBundle(ModuleDef.TYT,'res/tytGameConfig', JsonAsset, (err, jsonAsset) => {\r\n                if (err) {\r\n                    console.log(\"load gameconfig err:\", err)\r\n                    reject(err)\r\n                    return\r\n                }\r\n                this.gameConfig = jsonAsset.json\r\n                console.log(\"load gameconfig succes.\")\r\n                resolve(0)\r\n            })\r\n        })\r\n\r\n    }\r\n\r\n    loadAssert() {\r\n        return new Promise((resolve, reject) => {\r\n            const loadList = []\r\n            // 批量加载prefab\r\n            const loadMap = {\r\n                rolePrefab: 'res/prefabs/Role',\r\n                scoreTextPrefab: 'res/prefabs/ScoreText',\r\n            }\r\n            Object.keys(loadMap).forEach(key => {\r\n                const path = loadMap[key]\r\n                loadList.push(\r\n                    new Promise((resolve, reject) => {\r\n                        ResourceMgr.inst.loadResByModuleBundle(ModuleDef.TYT,path, Prefab, (err, prefab) => {\r\n                            if (err) {\r\n                                console.log(\"load err:\", err)\r\n                                reject(err)\r\n                                return\r\n                            }\r\n                            this[key] = prefab\r\n                            resolve(0)\r\n                        })\r\n                    })\r\n\r\n                )\r\n            })\r\n            // json配置里的prefab提前加载\r\n            const prefabUrls = []\r\n            Object.keys(this.gameConfig['footholds']).forEach(key => {\r\n                prefabUrls.push(this.gameConfig['footholds'][key]['prefabUrl'])\r\n            })\r\n            prefabUrls.forEach(prefabUrl => {\r\n                loadList.push(\r\n                    new Promise((resolve, reject) => {\r\n                        ResourceMgr.inst.loadResByModuleBundle(ModuleDef.TYT,prefabUrl, Prefab, (err, prefab) => {\r\n                            if (err) {\r\n                                console.log(\"load err:\", err)\r\n                                reject(err)\r\n                                return\r\n                            }\r\n                            this.prefabUrlMap[prefabUrl] = prefab\r\n                            resolve(0)\r\n                        })\r\n                    })\r\n\r\n                )\r\n            })\r\n            Promise.all([\r\n                ...loadList,\r\n                this.audioManager.loadAssert(),\r\n            ]).then(res => {\r\n                resolve(0)\r\n            })\r\n        })\r\n    }\r\n\r\n    setGameStauts(stauts: GameStatus) {\r\n        if (stauts === this.gameStatus) return\r\n        this.gameStatus = stauts\r\n        if (this.gameStatus === GameStatus.ready) {\r\n            this.readyUINode.active = true\r\n            this.runUINode.active = false\r\n            this.gameOverPopupNode.active = false\r\n        }\r\n        else if (this.gameStatus === GameStatus.running) {\r\n            this.readyUINode.active = false\r\n            this.runUINode.active = true\r\n            this.runUINode.getChildByPath('Tip').active = true\r\n        }\r\n        else if (this.gameStatus === GameStatus.end) {\r\n            this.gameOverPopupNode.active = true\r\n        }\r\n    }\r\n\r\n    initData() {\r\n        this.setGameStauts(GameStatus.ready)\r\n        this.footholdsNode.children.forEach(node => { node.destroy() })\r\n        this.roleContainerNode.children.forEach(node => { node.destroy() })\r\n        this.scoreTextsNode.children.forEach(node => { node.destroy() })\r\n        this.score = 0\r\n        // this.gameCameraNode.setWorldPosition(new Vec3(720, 360, 0))\r\n        // this.bgNode.setWorldPosition(new Vec3(720, 360, 0))\r\n        this.nowFootholdNode = this.generateFoothold(true)\r\n        this.roleNode = instantiate(this.rolePrefab)\r\n        this.roleContainerNode.addChild(this.roleNode)\r\n        this.roleImgNode = this.roleNode.getChildByPath('Img')\r\n        this.roleImgInitPos = this.roleImgNode.getPosition()\r\n        this.roleEffectStorageNode = this.roleNode.getChildByPath('Effects/Storage')\r\n        this.roleEffectStorageNode.active = false\r\n        this.roleEffectsNode = this.roleNode.getChildByPath('Effects')\r\n        this.roleEffectsInitPos = this.roleEffectsNode.getPosition()\r\n        // 角色初始动画\r\n        this.roleNode.setWorldPosition(new Vec3(720, 460, 0))\r\n        tween(this.roleNode).to(0.2, { worldPosition: new Vec3(720, 360, 0) }).start()\r\n        this.audioManager.playBirth()\r\n    }\r\n\r\n    generateFoothold(first = false) {\r\n        // 生成随机落脚点\r\n        const footholdKey = Object.keys(this.gameConfig['footholds'])[randomRangeInt(0, Object.keys(this.gameConfig['footholds']).length)]\r\n        const footholdNode: Node = instantiate(this.prefabUrlMap[this.gameConfig['footholds'][footholdKey]['prefabUrl']])\r\n        const imgNode = footholdNode.getChildByPath('Img')\r\n        // 为了让动画看着流畅\r\n        const imgInitPos = imgNode.getPosition()\r\n        imgNode.getComponent(UIOpacity).opacity = 0\r\n        imgNode.setPosition(imgNode.getPosition().add3f(0, 80, 0))\r\n        // 往前插入节点，让覆盖顺序正确（需要在设置位置之前）\r\n        this.footholdsNode.insertChild(footholdNode, 0)\r\n        if (first) {\r\n            footholdNode.setWorldPosition(new Vec3(720, 360))\r\n        } else {\r\n            const deg = this.gameConfig['config']['footholdDeg'][randomRangeInt(0, Object.keys(this.gameConfig['config']['footholdDeg']).length)]\r\n            const distance = randomRange(this.gameConfig['config']['footholdMinDistance'], this.gameConfig['config']['footholdMaxDistance'])\r\n            const direction = MyUtil.degreesToVector(deg)\r\n            // 新的落脚点位置需要在上一个落脚地位置基础上\r\n            footholdNode.setWorldPosition(this.nowFootholdNode.getWorldPosition().add3f(\r\n                direction.x * distance,\r\n                direction.y * distance,\r\n                0\r\n            ))\r\n        }\r\n        // 生成动画\r\n        tween(imgNode).parallel(\r\n            tween(imgNode.getComponent(UIOpacity)).to(0.2, { opacity: 255 }),\r\n            tween(imgNode).to(0.2, { position: imgInitPos })\r\n        ).start()\r\n        return footholdNode\r\n    }\r\n\r\n    pressTween: Tween = null\r\n\r\n    touchStart(event: EventTouch) {\r\n        if (this.gameStatus !== GameStatus.running || this.jumpFlag) return\r\n        this.pressFlag = true\r\n        this.pressTime = 0\r\n        // 角色蓄力粒子效果\r\n        this.roleEffectStorageNode.active = true\r\n        this.roleEffectStorageNode.getComponent(ParticleSystem2D).enabled = true\r\n        // 角色图片节点压缩（用角色节点会导致特效节点被压缩）\r\n        const roleTween = tween(this.roleImgNode).to(3, { scale: new Vec3(1.5, 0.5, 0) })\r\n        // 落脚点压缩\r\n        const footholdHeight = this.nowFootholdNode.getChildByPath('Img').getComponent(UITransform).contentSize.height\r\n        const foothodldTween = tween(this.nowFootholdNode.getChildByPath('Img'))\r\n            .to(3, { scale: new Vec3(1.1, 0.7, 0,) }, {\r\n                onUpdate: (imgNode: Node, ratio: number) => {\r\n                    // 在缩放过程中（角色、落脚点都会缩放），让角色往下移动\r\n                    this.roleImgNode.setPosition(this.roleImgInitPos.clone().subtract3f(\r\n                        0, footholdHeight - imgNode.getScale().y * footholdHeight, 0\r\n                    ))\r\n                    // 在缩放过程中，让特效节点往下移动，还需考虑角色图片被压缩情况\r\n                    this.roleEffectsNode.setPosition(this.roleEffectsInitPos.clone().subtract3f(\r\n                        0, (footholdHeight - imgNode.getScale().y * footholdHeight) * this.roleImgNode.getScale().y, 0\r\n                    ))\r\n                },\r\n            })\r\n        this.pressTween = tween(this.roleNode).parallel(roleTween, foothodldTween).start()\r\n        this.audioManager.playStorage()\r\n    }\r\n\r\n    touchEnd(event: EventTouch) {\r\n        if (this.gameStatus !== GameStatus.running || this.jumpFlag || this.pressTime === 0) return\r\n        this.pressFlag = false;\r\n        this.pressTween.stop();\r\n        this.roleEffectStorageNode.active = false;\r\n        this.roleEffectStorageNode.getComponent(ParticleSystem2D).enabled = false;\r\n        this.audioManager.stopPlaySound();\r\n\r\n        const touchMaxTime = this.gameConfig['config']['touchMaxTime']\r\n        const ratio = this.pressTime < touchMaxTime ? this.pressTime / touchMaxTime : 1\r\n        const distance = this.gameConfig['config']['jumpMaxDistance'] * ratio\r\n        const rolePos = this.roleNode.getWorldPosition()\r\n        // 计算方向需要朝着下一个落脚点中心位置（为了跳的离中心越近得2分）\r\n        const direction = this.nextFootholdNode.getWorldPosition().subtract(rolePos).normalize()\r\n        const targetPos = new Vec3(\r\n            rolePos.x + direction.x * distance,\r\n            rolePos.y + direction.y * distance,\r\n            0\r\n        )\r\n        const deg = MyUtil.angle(direction) * 180 / Math.PI\r\n        const leftRotateFlag = deg > 90 && deg < 270\r\n        const jumpAniRunTime = ratio < 0.1 ? 0.25 : 0.35\r\n        this.pressTime = 0\r\n        this.jumpFlag = true\r\n        // 角色点到点移动的动画\r\n        const moveTween = tween(this.roleNode).to(jumpAniRunTime, { worldPosition: targetPos })\r\n        // 角色跳跃动画（配合点到点动画模拟空中弧线效果）\r\n        const upTween = tween(this.roleImgNode)\r\n            .to(jumpAniRunTime / 2, { position: this.roleImgInitPos.clone().add3f(0, 700, 0).multiplyScalar(ratio) })\r\n            .to(jumpAniRunTime / 2, { position: this.roleImgInitPos })\r\n        // 角色空中旋转动画，需要控制左旋、右旋\r\n        const rotateTween = tween(this.roleImgNode)\r\n            .to(jumpAniRunTime / 2, { angle: leftRotateFlag ? 180 : -180 })\r\n            .to(jumpAniRunTime / 2, { angle: leftRotateFlag ? 360 : -360 })\r\n            .to(0, { angle: 0 })\r\n        tween(this.roleNode)\r\n            // 蓄力时的回弹动画\r\n            .parallel(\r\n                tween(this.roleImgNode).to(0.15, { position: this.roleImgInitPos, scale: new Vec3(1, 1, 0) }),\r\n                tween(this.roleEffectsNode).to(0.15, { position: this.roleEffectsInitPos }),\r\n                tween(this.nowFootholdNode.getChildByPath('Img')).to(0.15, { scale: new Vec3(1, 1.2, 0) })\r\n            )\r\n            // 整体跳跃动画\r\n            .parallel(\r\n                tween(this.nowFootholdNode.getChildByPath('Img')).to(0.05, { scale: new Vec3(1, 1, 0) }),\r\n                moveTween, upTween, rotateTween\r\n            )\r\n            .call(() => { this.jumpEnd() })\r\n            .start()\r\n    }\r\n\r\n    viewUpdate() {\r\n        const direction = this.nextFootholdNode.getWorldPosition().subtract(this.nowFootholdNode.getWorldPosition()).normalize()\r\n        return new Promise((resolve, reject) => {\r\n            tween(this.gameCameraNode.getWorldPosition()).to(\r\n                0.4,\r\n                // 相机移动是相反的运动（镜头往上移动，相对物体是显示向下运动）\r\n                this.roleNode.getWorldPosition().add3f(0, 20, 0).add(direction.clone().multiplyScalar(80)),\r\n                {\r\n                    easing: \"quadOut\",\r\n                    onUpdate: (target: Vec3, ratio: number) => {\r\n                        // 实时修改摄像机、背景位置\r\n                        this.gameCameraNode.setWorldPosition(target)\r\n                        this.bgNode.setWorldPosition(target)\r\n                    },\r\n                    onComplete: (target?: Vec3) => {\r\n                        resolve(0)\r\n                    },\r\n                }\r\n            ).start()\r\n        })\r\n    }\r\n\r\n    jumpEnd() {\r\n        this.runUINode.getChildByPath('Tip').active = false\r\n        const footholdConfig = this.gameConfig['footholds'][this.nextFootholdNode.name]\r\n        const nowDistance = Vec3.distance(this.roleNode.getWorldPosition(), this.nowFootholdNode.getWorldPosition())\r\n        const nowFootHoldRadius = this.gameConfig['footholds'][this.nowFootholdNode.name]['radius']\r\n        const nextDistance = Vec3.distance(this.roleNode.getWorldPosition(), this.nextFootholdNode.getWorldPosition())\r\n        const nextFootHoldRadius = this.gameConfig['footholds'][this.nextFootholdNode.name]['radius']\r\n        // 跳到下一个\r\n        if (nextDistance <= nextFootHoldRadius) {\r\n            if (nextDistance > 3) {\r\n                this.audioManager.playScore()\r\n                this.score += 1\r\n                this.generateScoreText()\r\n            } else {\r\n                this.audioManager.playExactScore()\r\n                this.score += footholdConfig['exactScore'] || 2\r\n                this.generateScoreText(footholdConfig['exactScore'] || 2)\r\n                // 精准跳跃特效\r\n                const runtime = 0.6\r\n                const exactScoreNode = this.roleEffectsNode.getChildByPath('ExactScore')\r\n                const exactScoreOpacity = exactScoreNode.getComponent(UIOpacity)\r\n                exactScoreNode.active = true\r\n                tween(exactScoreNode).parallel(\r\n                    tween(exactScoreNode).to(runtime, { scale: new Vec3(2, 2) }),\r\n                    tween(exactScoreOpacity).to(0, { opacity: 0 }).to(runtime * 0.2, { opacity: 220 }).to(runtime * 0.6, { opacity: 220 }).to(runtime * 0.2, { opacity: 0 })\r\n                ).call(() => {\r\n                    exactScoreNode.active = false\r\n                    exactScoreNode.setScale(1, 1)\r\n                }).start()\r\n            }\r\n            // 生成下一个落脚点\r\n            this.nowFootholdNode = this.nextFootholdNode\r\n            this.nextFootholdNode = this.generateFoothold()\r\n            // 视角\r\n            this.viewUpdate().then(() => {\r\n                this.jumpFlag = false\r\n            })\r\n            // 只留x个落脚点\r\n            if (this.footholdsNode.children.length > 8) {\r\n                this.footholdsNode.children[this.footholdsNode.children.length - 1].destroy()\r\n            }\r\n        }\r\n        // 原地挪\r\n        else if (nowDistance <= nowFootHoldRadius) {\r\n            this.viewUpdate().then(() => {\r\n                this.jumpFlag = false\r\n            })\r\n        }\r\n        // 掉落，游戏结束\r\n        else {\r\n            this.audioManager.playDie()\r\n            // 更改角色掉落时的节点顺序，达到正确覆盖效果，判断在落脚点的前面还是后面\r\n            const nextFlag = Vec3.distance(this.roleNode.getWorldPosition(), this.nowFootholdNode.getWorldPosition()) - Vec3.distance(this.nextFootholdNode.getWorldPosition(), this.nowFootholdNode.getWorldPosition()) > 0\r\n            this.footholdsNode.insertChild(this.roleNode, nextFlag ? 0 : 1)\r\n            // 掉落动画\r\n            tween(this.roleImgNode).to(0.6, { position: this.roleImgInitPos.clone().add3f(0, -40, 0) }).call(() => {\r\n                this.gameOver()\r\n                this.jumpFlag = false\r\n            }).start()\r\n        }\r\n    }\r\n\r\n    generateScoreText(score: number = 1) {\r\n        const textNode = instantiate(this.scoreTextPrefab)\r\n        this.scoreTextsNode.addChild(textNode)\r\n        textNode.getComponent(Label).string = `+${score}`\r\n        //文本节点起始位置在角色头顶上方 + x\r\n        const startPos = this.roleNode.getWorldPosition().add3f(\r\n            0, this.roleNode.getComponent(UITransform).contentSize.height + 10, 0\r\n        )\r\n        textNode.setWorldPosition(startPos)\r\n        tween(textNode).parallel(\r\n            // 消失动画\r\n            tween(textNode.getComponent(UIOpacity)).to(0, { opacity: 255 }).to(0.7, { opacity: 255 }).to(0.3, { opacity: 0 }),\r\n            // 移动动画\r\n            tween(textNode).to(1, { worldPosition: startPos.clone().add3f(0, 30, 0) })\r\n        ).call(() => {\r\n            textNode.destroy()\r\n        }).start()\r\n    }\r\n\r\n    gameOver() {\r\n        this.setGameStauts(GameStatus.end)\r\n        this.roleNode.destroy()\r\n    }\r\n\r\n    onBeginBtnClick() {\r\n        this.setGameStauts(GameStatus.running)\r\n        this.nextFootholdNode = this.generateFoothold()\r\n        this.viewUpdate()\r\n    }\r\n\r\n    onAgainBtnClick() {\r\n        this.initData()\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        if (this.gameStatus === GameStatus.running) {\r\n            if (this.pressFlag) {\r\n                this.pressTime += deltaTime\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { GameMgr } from '../../module_basic/scripts/GameMgr';\r\nimport { SubGameMgr } from '../../module_basic/scripts/SubGameMgr';\r\nimport { SubGameDef } from '../../module_basic/scripts/SubGameDef';\r\nimport { ModuleDef } from '../../scripts/ModuleDef';\r\nimport { RoomMgr } from '../../module_basic/scripts/RoomMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('TYTGameMgr')\r\nexport class TYTGameMgr extends GameMgr {\r\n    private static _inst: TYTGameMgr;\r\n        public static get inst(): TYTGameMgr {\r\n            if (!this._inst) {\r\n                this._inst = new TYTGameMgr();\r\n            }\r\n            return this._inst;\r\n        }\r\n    \r\n        constructor() {\r\n            super();\r\n            this._gameType = SubGameDef.TYT;\r\n            this._entryScene = { name: 'lobby_TYT', bundle: ModuleDef.TYT };\r\n            this._gameScene = { name: 'tyt', bundle: ModuleDef.TYT };\r\n            this.initNetMsgHandlers();\r\n        }\r\n    \r\n        initNetMsgHandlers() {\r\n    \r\n        }\r\n    \r\n        initSoloMode() {\r\n            RoomMgr.inst.reset();\r\n            this.reset();\r\n            SubGameMgr.gameMgr = this;\r\n        }\r\n}\r\n\r\nSubGameMgr.inst.registerGameMgr(TYTGameMgr.inst);\r\n","import { _decorator, Component, Node } from 'cc';\r\nimport { RoomMgr } from '../../module_basic/scripts/RoomMgr';\r\nimport { GameMode } from '../../module_basic/scripts/GameMgr';\r\nimport { TYTGameMgr } from './TYTGameMgr';\r\nimport { UserMgr } from '../../module_basic/scripts/UserMgr';\r\nimport { SceneDef } from '../../scripts/SceneDef';\r\nimport { lobbyNet } from '../../module_basic/scripts/NetGameServer';\r\nimport { UIChat } from '../../module_basic/ui_chat/UIChat';\r\nimport { UIAnnouncement } from '../../module_basic/ui_announcement/UIAnnouncement';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('TYTLobbyScene')\r\nexport class TYTLobbyScene extends Component {\r\n    @property(Node) announcementPlacer: Node;\r\n\r\n    async start() {\r\n        if (!UserMgr.inst.uid) {\r\n            tgx.SceneUtil.loadScene(SceneDef.START);\r\n            return;\r\n        }\r\n\r\n        tgx.UIMgr.inst.closeAll();\r\n\r\n        tgx.UIMgr.inst.showUI(UIAnnouncement, (ui: UIAnnouncement) => {\r\n            ui.setPosition(this.announcementPlacer.position.x, this.announcementPlacer.position.y);\r\n        });\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n\r\n    onBtnSoloModeClicked() {\r\n        TYTGameMgr.inst.initSoloMode();\r\n        tgx.UIWaiting.show();\r\n        tgx.SceneUtil.loadScene(TYTGameMgr.inst.gameScene);\r\n    }\r\n}\r\n\r\n\r\n"]}